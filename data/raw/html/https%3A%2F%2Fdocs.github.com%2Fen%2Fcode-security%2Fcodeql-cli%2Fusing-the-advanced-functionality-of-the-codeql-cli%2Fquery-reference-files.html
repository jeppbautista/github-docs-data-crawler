<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="CodeQL CLI" href="/en/code-security/codeql-cli">CodeQL CLI</a><span>/</span>
</li>
<li>
<a title="Advanced functionality" href="/en/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli">Advanced functionality</a><span>/</span>
</li>
<li><a title="Query reference files" href="/en/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli/query-reference-files">Query reference files</a></li>
</ul></nav></div>
<div>
<div><div><h1>Query reference files</h1></div></div>
<div>
<div><p>You can use query reference files to define the location of a query you want to run in tests.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div>
<p>CodeQL is available for the following repository types:</p>
<ul>
<li>Public repositories on GitHub.com, see <a href="https://github.com/github/codeql-cli-binaries/blob/main/LICENSE.md">GitHub CodeQL Terms and Conditions</a>
</li>
<li>Organization-owned repositories on GitHub Team with <a href="/en/get-started/learning-about-github/about-github-advanced-security">GitHub Code Security</a> enabled</li>
</ul>
</div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-query-reference-files"><div><span>About query reference files</span></div></a></li>
<li><a href="#defining-a-query-reference-file"><div><span>Defining a query reference file</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-query-reference-files">About query reference files</a></h2>
<p>A query reference file is text file that defines the location of one query to test.</p>
<p>You use a query reference file when you want to tell the <code>test run</code> subcommand
to run a query that’s not part of a test directory.
There are two ways to specify queries that you want to run as tests:</p>
<ol>
<li>Use a query reference file to specify the location of a query to test.
This is useful when you create tests for alert and path queries that
are intended to identify problems in real codebases. You might create
several directories of test code, each focusing on different
aspects of the query. Then you would add a query reference file to
each directory of test code, to specify the query to test.</li>
<li>Add the query directly to a directory of tests.
These is typically useful when you’re writing queries explicitly to test the behavior
of QL libraries. Often these queries contain just a few calls to library predicates,
wrapping them in a <code>select</code> statement so their output can be tested.</li>
</ol>
<h2><a href="#defining-a-query-reference-file">Defining a query reference file</a></h2>
<p>Each query reference file, <code>.qlref</code>, contains a single line that defines
where to find one query. The location must be defined relative
to the root of the CodeQL pack that contains the query.
Usually, this is either the CodeQL pack that contains the <code>.qlref</code>, a CodeQL pack specified in the <code>dependencies</code> block for the test pack, or a transitive dependency of the CodeQL pack.</p>
<p>You should use forward slashes in the path on all operating
systems to ensure compatibility between systems.</p>
<h3><a href="#example">Example</a></h3>
<p>A query reference file to test a JavaScript alert query:
<a href="https://github.com/github/codeql/blob/main/javascript/ql/test/query-tests/AngularJS/DeadAngularJSEventListener/DeadAngularJSEventListener.qlref">DeadAngularJSEventListener.qlref</a></p>
<p>The <code>qlpack.yml</code> file, <a href="https://github.com/github/codeql/blob/main/javascript/ql/test/qlpack.yml">https://github.com/github/codeql/blob/main/javascript/ql/test/qlpack.yml</a>,
for the CodeQL pack at <code>javascript/ql/test</code> defines <code>codeql/javascript-queries</code> as
a dependency. So the query reference file defines the location of the query relative
to the <code>codeql/javascript-queries</code> CodeQL pack:</p>
<pre><code>AngularJS/DeadAngularJSEventListener.ql
</code></pre>
<p>For another example, see <a href="/en/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli/testing-custom-queries">Testing custom queries</a>.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>