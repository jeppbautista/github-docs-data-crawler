<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Code scanning" href="/en/code-security/code-scanning">Code scanning</a><span>/</span>
</li>
<li>
<a title="Troubleshooting SARIF uploads" href="/en/code-security/code-scanning/troubleshooting-sarif-uploads">Troubleshooting SARIF uploads</a><span>/</span>
</li>
<li><a title="Results exceed limits" href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/results-exceed-limit">Results exceed limits</a></li>
</ul></nav></div>
<div>
<div><div><h1>SARIF results exceed one or more limits</h1></div></div>
<div><div><p>Learn how to resolve problems when a SARIF file is rejected by code scanning because one or more limits is exceeded.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-code-scanning-limits-on-sarif-results"><div><span>About code scanning limits on SARIF results</span></div></a></li>
<li><a href="#fixing-soft-limit-errors"><div><span>Fixing soft limit errors</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-results-limits"><div><span>Fixing "Analysis SARIF file rejected due to results limits"</span></div></a></li>
<li><a href="#fixing-alerts-in-sarif-file-exceeded-thread-flow-location-limits"><div><span>Fixing "Alert(s) in SARIF file exceeded thread flow location limits"</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-run-limits"><div><span>Fixing "Analysis SARIF file rejected due to run limits"</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-rule-limits"><div><span>Fixing "Analysis SARIF file rejected due to rule limits"</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-extension-limits"><div><span>Fixing "Analysis SARIF file rejected due to extension limits"</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-location-limit"><div><span>Fixing "Analysis SARIF file rejected due to location limit"</span></div></a></li>
<li><a href="#fixing-analysis-sarif-file-rejected-due-to-rule-tag-limits"><div><span>Fixing "Analysis SARIF file rejected due to rule tag limits"</span></div></a></li>
<li><a href="#fixing-repository-is-at-risk-of-exceeding-the-alert-limit--all-analysis-uploads-blocked-due-to-alert-limit"><div><span>Fixing "Repository is at risk of exceeding the alert limit" &amp; "All analysis uploads blocked due to alert limit"</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-code-scanning-limits-on-sarif-results">About code scanning limits on SARIF results</a></h2>
<pre><code># SARIF results exceed soft limits
  Locations for an alert exceeded limits
  Analysis SARIF file exceeded alert limits
  Rule tags in SARIF file exceed limits
  Alert in SARIF upload exceeded thread flow location limits
  Repository is at risk of exceeding the alert limit.

# SARIF results exceed hard limit
  Alert(s) in SARIF file exceeded thread flow location limits
  Analysis SARIF file rejected due to extension limits
  Analysis SARIF file rejected due to location limit
  Analysis SARIF file rejected due to rule tag limits
  Analysis SARIF file rejected due to result limits
  Analysis SARIF file rejected due to rule limits
  Analysis SARIF file rejected due to run limits
  All analysis uploads blocked due to alert limit
</code></pre>
<p>Code scanning sets two types of limits on fields in SARIF results files.</p>
<ul>
<li>Soft limits which determine how much data is stored and displayed to users.</li>
<li>Hard limits which determine the maximum amount of data accepted for processing.</li>
</ul>
<p>You could see these errors for SARIF files generated by CodeQL or by third-party analysis tools.</p>
<div>


















































<table>
<thead><tr>
<th><strong>SARIF data</strong></th>
<th><strong>Maximum values</strong></th>
<th><strong>Data truncation limits</strong></th>
</tr></thead>
<tbody>
<tr>
<th>Runs per file</th>
<td>20</td>
<td>None</td>
</tr>
<tr>
<th>Results per run</th>
<td>25,000</td>
<td>Only the top 5,000 results will be included, prioritized by severity.</td>
</tr>
<tr>
<th>Rules per run</th>
<td>25,000</td>
<td>None</td>
</tr>
<tr>
<th>Tool extensions per run</th>
<td>100</td>
<td>None</td>
</tr>
<tr>
<th>Thread Flow Locations per result</th>
<td>10,000</td>
<td>Only the top 1,000 Thread Flow Locations will be included, using prioritization.</td>
</tr>
<tr>
<th>Location per result</th>
<td>1,000</td>
<td>Only 100 locations will be included.</td>
</tr>
<tr>
<th>Tags per rule</th>
<td>20</td>
<td>Only 10 tags will be included.</td>
</tr>
<tr>
<th>Alert Limit</th>
<td>1,000,000</td>
<td>None</td>
</tr>
</tbody>
</table>
</div>
<p>For information about validating your SARIF file, see <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#validating-your-sarif-file">SARIF support for code scanning</a>.</p>
<h2><a href="#fixing-soft-limit-errors">Fixing soft limit errors</a></h2>
<p>When soft limits are exceeded, code scanning shows the highest priority information. Often you do not need to make any changes to your code scanning configuration. As your team fixes alerts, the number of results reported in each run will reduce until they are within the soft limits and all results are displayed. Alternatively, you can use the approaches described for hard limit errors.</p>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-results-limits">Fixing "Analysis SARIF file rejected due to results limits"</a></h2>
<p>There are many considerations and potential solutions for reducing the number of results included in a SARIF results file. For guidance, see <a href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/file-too-large">SARIF results file is too large</a>.</p>
<h2><a href="#fixing-alerts-in-sarif-file-exceeded-thread-flow-location-limits">Fixing "Alert(s) in SARIF file exceeded thread flow location limits"</a></h2>
<p>You can configure the analysis to limit the number of dataflow paths included in the results. By default, 4 dataflow paths are included for each result.</p>
<ul>
<li>
<p>CodeQL advanced setup for code scanning: update the <code>analyze</code> step to limit the number of paths to a maximum of one or zero.</p>
<pre><code><span>-</span> <span>name:</span> <span>Perform</span> <span>CodeQL</span> <span>Analysis</span>
  <span>uses:</span> <span>github/codeql-action/analyze@v3</span>
  <span>env:</span> 
    <span>CODEQL_ACTION_EXTRA_OPTIONS:</span> <span>'{"database":{"interpret-results":["--max-paths", 1]}}'</span>
</code></pre>
</li>
<li>
<p>CodeQL CLI <code>database analyze</code>: update the database analysis command to include the <code>--max-paths=1</code> flag. For more information, see <a href="/en/code-security/codeql-cli/codeql-cli-manual/database-analyze#--max-pathsmaxpaths">database analyze</a>.</p>
</li>
</ul>
<div>
<p>
The <code>max-paths</code> setting affects the results of all dataflow queries.</p>
</div>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-run-limits">Fixing "Analysis SARIF file rejected due to run limits"</a></h2>
<p>The simplest approach is generate a new SARIF file for each run and upload each file separately. You add a "category" to each results and this enables code scanning to store and display the results appropriately. For more information, see <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#uploading-more-than-one-sarif-file-for-a-commit">SARIF support for code scanning</a>.</p>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-rule-limits">Fixing "Analysis SARIF file rejected due to rule limits"</a></h2>
<p>There are two possible approaches here.</p>
<ol>
<li>Reduce the number of rules you use to analyze the code. For more information, see <a href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/file-too-large#defining-the-query-suite-to-run">Defining the query suite to run</a> and <a href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/file-too-large#excluding-a-query-from-analysis">Excluding a query from analysis</a> in "SARIF results file too large."</li>
<li>Run the analysis twice, each time with a different set of rules, and upload both results files to code scanning. For more information, see <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#uploading-more-than-one-sarif-file-for-a-commit">SARIF support for code scanning</a>.</li>
</ol>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-extension-limits">Fixing "Analysis SARIF file rejected due to extension limits"</a></h2>
<p>The simplest approach is to create a separate SARIF file each time you run the tool and upload each file separately. You may also need to contact the maintainer of the tool. For more information, see <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#uploading-more-than-one-sarif-file-for-a-commit">SARIF support for code scanning</a>.</p>
<p>CodeQL analysis should not generate this error. If you see this error while using the CodeQL action or CodeQL CLI, you should contact GitHub Support to let us know. For more information, see <a href="/en/support/contacting-github-support">Contacting GitHub Support</a>.</p>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-location-limit">Fixing "Analysis SARIF file rejected due to location limit"</a></h2>
<p>The best way to resolve this problem is usually to identify the query that reports too many locations and exclude it from analysis. For information on how to do this, see <a href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/file-too-large#excluding-a-query-from-analysis">SARIF results file is too large</a>.</p>
<h2><a href="#fixing-analysis-sarif-file-rejected-due-to-rule-tag-limits">Fixing "Analysis SARIF file rejected due to rule tag limits"</a></h2>
<p>You need to update the SARIF file or the generator so that the array of tags reported for each <code>reportingDescriptor</code> object is fewer than 10. For more information, see <code>properties.tags[]</code> in <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#reportingdescriptor-object">SARIF support for code scanning</a>.</p>
<h2><a href="#fixing-repository-is-at-risk-of-exceeding-the-alert-limit--all-analysis-uploads-blocked-due-to-alert-limit">Fixing "Repository is at risk of exceeding the alert limit" &amp; "All analysis uploads blocked due to alert limit"</a></h2>
<p>This limit is triggered by a repository producing more unique alerts than should ever exist as part of a well functioning code scanning configuration.
It is possible that this is due to the output of a third-party tool being used, and may not be a user configuration error.
Both user configuration error and tool vendor error are possible causes.</p>
<p>There are a few steps to fix this problem.</p>
<ol>
<li>Look at the SARIF files you are producing to identify the cause of code scanning alerts being classed as distinct across runs of a tool. Usually this is due to one of the following:
<ul>
<li>The SARIF <code>artifactLocation.uri</code> property (filepath in the code scanning alert user interface) is not deterministic due to the inclusion of temporary directories or generated file names.</li>
<li>The tool used produces unstable SARIF rule names or <code>artifactLocation object uri property</code> values, which is usually the result of using hashes (from git commits or docker image SHAs, for example) or other sources of data that change across runs or environments.</li>
</ul>
</li>
<li>Once you have identified the source of the issue, you should update your configuration accordingly, and contact the tool vendor if their tool is the source of the unstable SARIF results.</li>
<li>Stop uploading code scanning results for any third-party tools that produce non-deterministic output until they have been fixed by the tool vendor.</li>
</ol>
<h3><a href="#additional-steps-for-all-analysis-uploads-blocked-due-to-alert-limit">Additional steps for "All analysis uploads blocked due to alert limit"</a></h3>
<p>On top of fixing the code scanning configuration and removing or fixing the output of third-party tools, you will need to contact us through the <a href="https://support.github.com">GitHub Support portal</a> to assist you in deleting the alerts for any offending configurations.</p>
<p><strong>There is no self-service method for deleting alerts at this time, so contacting customer support is necessary before code-scanning can be re-enabled.</strong></p>
</div></div></div>
</div>
</div></main>
</div></body></html>