<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Codespaces" href="/en/codespaces">Codespaces</a><span>/</span>
</li>
<li>
<a title="Reference" href="/en/codespaces/reference">Reference</a><span>/</span>
</li>
<li><a title="Access a private registry" href="/en/codespaces/reference/allowing-your-codespace-to-access-a-private-registry">Access a private registry</a></li>
</ul></nav></div>
<div>
<div><div><h1>Allowing your codespace to access a private registry</h1></div></div>
<div><div><p>You can allow GitHub Codespaces to access container images or other packages in a private registry.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-private-registries-and-github-codespaces"><div><span>About private registries and GitHub Codespaces</span></div></a></li>
<li><a href="#accessing-packages-stored-in-registries-with-granular-permissions"><div><span>Accessing packages stored in registries with granular permissions</span></div></a></li>
<li><a href="#accessing-images-stored-in-other-registries"><div><span>Accessing images stored in other registries</span></div></a></li>
<li><a href="#debugging-private-image-registry-access"><div><span>Debugging private image registry access</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-private-registries-and-github-codespaces">About private registries and GitHub Codespaces</a></h2>
<p>A registry is a secure space for storing, managing, and fetching container images or other packages. There are many examples of registries, such as:</p>
<ul>
<li>GitHub's Container registry, the Azure Container Registry, and DockerHub for container images</li>
<li>The npm registry for Node.js packages.</li>
</ul>
<p>Certain GitHub Packages registries, including the Container registry, can be configured to allow packages to be pulled seamlessly into GitHub Codespaces during codespace creation, without having to provide any authentication credentials.</p>
<p>To access other container image registries, you can create secrets in GitHub to store the access details, which will allow GitHub Codespaces to access images stored in that registry.</p>
<h2><a href="#accessing-packages-stored-in-registries-with-granular-permissions">Accessing packages stored in registries with granular permissions</a></h2>
<p>GitHub Packages registries that support granular permissions, including the Container registry, provide the easiest way for GitHub Codespaces to consume packages. For the list of GitHub Packages registries that support granular permissions and seamless GitHub Codespaces access, see <a href="/en/packages/learn-github-packages/about-permissions-for-github-packages#granular-permissions-for-userorganization-scoped-packages">About permissions for GitHub Packages</a>.</p>
<h3><a href="#accessing-a-package-published-to-the-same-repository-as-the-codespace">Accessing a package published to the same repository as the codespace</a></h3>
<p>If you publish a package in the same repository that the codespace is being launched in, you will automatically be able to fetch that package on codespace creation. You won't have to provide any additional credentials, unless the <strong>Inherit access from repo</strong> option was unselected when the package was published.</p>
<h4><a href="#inheriting-access-from-the-repository-from-which-a-package-was-published">Inheriting access from the repository from which a package was published</a></h4>
<p>By default, the package inherits the access setting of the repository from which it was published. For example, if the repository is public, the package is also public. If the repository is private, the package is also private, but is accessible from the repository.</p>
<p>This behavior is controlled by the <strong>Inherit access from repo</strong> option. <strong>Inherit access from repo</strong> is selected by default when publishing via GitHub Actions, but not when publishing directly to a registry using a personal access token.</p>
<p>If the <strong>Inherit access from repo</strong> option was not selected when the package was published, you can manually add the repository to the published package's access controls. For more information, see <a href="/en/packages/learn-github-packages/configuring-a-packages-access-control-and-visibility#inheriting-access-for-a-container-image-from-a-repository">Configuring a package's access control and visibility</a>.</p>
<h3><a href="#accessing-a-package-published-to-the-organization-a-codespace-will-be-launched-in">Accessing a package published to the organization a codespace will be launched in</a></h3>
<p>If you want a package to be accessible to all codespaces in an organization, we recommend that you publish the package with internal visibility. This will automatically make the package visible to all codespaces within the organization, unless the repository the codespace is launched from is public.</p>
<p>If the codespace is being launched from a public repository referencing an internal or private package, you must manually allow the public repository access to the internal package. This prevents the internal package from being accidentally leaked publicly. For more information, see <a href="/en/packages/learn-github-packages/configuring-a-packages-access-control-and-visibility#ensuring-codespaces-access-to-your-package">Configuring a package's access control and visibility</a>.</p>
<h3><a href="#accessing-a-private-package-from-a-subset-of-repositories-in-an-organization">Accessing a private package from a subset of repositories in an organization</a></h3>
<p>If you want to allow a subset of an organization's repositories to access a package, or allow an internal or private package to be accessed from a codespace launched in a public repository, you can manually add repositories to a package's access settings. For more information, see <a href="/en/packages/learn-github-packages/configuring-a-packages-access-control-and-visibility#ensuring-codespaces-access-to-your-package">Configuring a package's access control and visibility</a>.</p>
<h3><a href="#publishing-a-package-from-a-codespace">Publishing a package from a codespace</a></h3>
<p>Seamless access from a codespace to a registry is limited to pulling packages. If you want to publish a package from inside a codespace, you must use a personal access token (classic) with the <code>write:packages</code> scope.</p>
<p>We recommend publishing packages via GitHub Actions. For more information, see <a href="/en/actions/publishing-packages/publishing-docker-images">Publishing Docker images</a> and <a href="/en/actions/publishing-packages/publishing-nodejs-packages">Publishing Node.js packages</a>.</p>
<h2><a href="#accessing-images-stored-in-other-registries">Accessing images stored in other registries</a></h2>
<p>You can define secrets to allow GitHub Codespaces to access container image registries other than GitHub's Container registry. If you are accessing a container image from a registry that doesn't support seamless access, GitHub Codespaces checks for the presence of three secrets, which define the server name, username, and personal access token for a registry. If these secrets are found, GitHub Codespaces will make the registry available inside your codespace.</p>
<ul>
<li><code>&lt;*&gt;_CONTAINER_REGISTRY_SERVER</code></li>
<li><code>&lt;*&gt;_CONTAINER_REGISTRY_USER</code></li>
<li><code>&lt;*&gt;_CONTAINER_REGISTRY_PASSWORD</code></li>
</ul>
<p>You can store secrets at the user, repository, or organization-level, allowing you to share them securely between different codespaces. When you create a set of secrets for a private image registry, you need to replace the "&lt;*&gt;" in the name with a consistent identifier. For more information, see <a href="/en/codespaces/managing-your-codespaces/managing-your-account-specific-secrets-for-github-codespaces">Managing your account-specific secrets for GitHub Codespaces</a> and <a href="/en/codespaces/managing-codespaces-for-your-organization/managing-development-environment-secrets-for-your-repository-or-organization">Managing development environment secrets for your repository or organization</a>.</p>
<p>If you are setting the secrets at the user or organization level, make sure to assign those secrets to the repository you'll be creating the codespace in by choosing an access policy from the dropdown list.</p>
<picture><source><img src="/assets/cb-43477/images/help/codespaces/secret-repository-access.png" alt='Screenshot of the "Repository access" dropdown menu with the options "All repositories," "Private repositories," and "Selected repositories."' width="338" height="307"></source></picture>
<h3><a href="#pulling-a-docker-image-into-your-codespace">Pulling a Docker image into your codespace</a></h3>
<p>GitHub Codespaces uses Docker, so to pull a private Docker image inside your codespace at runtime, you need to be able to use Docker-in-Docker. To make this possible, the secrets required for login to Docker are automatically added to the <code>~/.docker/config.json</code> file within your codespace. This happens after the <code>onCreateCommand</code> lifecycle hook but before <code>postCreateCommand</code>, <code>postStartCommand</code>, and <code>postAttachCommand</code>. As a result, <code>postCreateCommand</code> will be able to use Docker-in-Docker to pull a Docker image into the codespace, but <code>onCreateCommand</code> will not. For this reason, Docker-in-Docker is not available during prebuild creation.</p>
<p>After the codespace is running you will be able to open a terminal in the codespace and run the command <code>docker pull PRIVATE-IMAGE-URL</code>.</p>
<h3><a href="#example-secrets">Example secrets</a></h3>
<p>For a private image registry in Azure, you could create the following secrets:</p>
<pre><code>ACR_CONTAINER_REGISTRY_SERVER = mycompany.azurecr.io
ACR_CONTAINER_REGISTRY_USER = acr-user-here
ACR_CONTAINER_REGISTRY_PASSWORD = &lt;PERSONAL_ACCESS_TOKEN&gt;
</code></pre>
<p>For information on common image registries, see <a href="#common-image-registry-servers">Common image registry servers</a>. Note that accessing AWS Elastic Container Registry (ECR) is different.</p>
<p><picture><source><img src="/assets/cb-58328/images/help/codespaces/codespaces-image-registry-secret-example.png" alt='Screenshot of the "Codespaces secrets" settings for a repository. Three secrets for ACR Container Registry are set.' width="720" height="305"></source></picture></p>
<p>Once you've added the secrets, you may need to stop and then start the codespace you are in for the new environment variables to be passed into the container. For more information, see <a href="/en/codespaces/reference/using-the-vs-code-command-palette-in-codespaces#suspending-or-stopping-a-codespace">Using the Visual Studio Code Command Palette in GitHub Codespaces</a>.</p>
<h4><a href="#accessing-aws-elastic-container-registry">Accessing AWS Elastic Container Registry</a></h4>
<p>To access AWS Elastic Container Registry (ECR), you can provide an AWS access key ID and secret key, and GitHub can retrieve an access token for you and log in on your behalf.</p>
<pre><code>*_CONTAINER_REGISTRY_SERVER = &lt;ECR_URL&gt;
*_CONTAINER_REGISTRY_USER = &lt;AWS_ACCESS_KEY_ID&gt;
*_CONTAINER_REGISTRY_PASSWORD = &lt;AWS_SECRET_KEY&gt;
</code></pre>
<p>You must also ensure you have the appropriate AWS IAM permissions to perform the credential swap (e.g. <code>sts:GetServiceBearerToken</code>) as well as the ECR read operation (either <code>AmazonEC2ContainerRegistryFullAccess</code> or <code>ReadOnlyAccess</code>).</p>
<p>Alternatively, if you don't want GitHub to perform the credential swap on your behalf, you can provide an authorization token fetched via AWS's APIs or CLI.</p>
<pre><code>*_CONTAINER_REGISTRY_SERVER = &lt;ECR_URL&gt;
*_CONTAINER_REGISTRY_USER = AWS
*_CONTAINER_REGISTRY_PASSWORD = &lt;TOKEN&gt;
</code></pre>
<p>Since these tokens are short lived and need to be refreshed periodically, we recommend providing an access key ID and secret.</p>
<p>While these secrets can have any name, so long as the <code>*_CONTAINER_REGISTRY_SERVER</code> is an ECR URL, we recommend using <code>ECR_CONTAINER_REGISTRY_*</code> unless you are dealing with multiple ECR registries.</p>
<p>For more information, see AWS ECR's <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/registry_auth.html">Private registry authentication documentation</a>.</p>
<h3><a href="#common-image-registry-servers">Common image registry servers</a></h3>
<p>Some of the common image registry servers are listed below:</p>
<ul>
<li>
<a href="https://docs.docker.com/engine/reference/commandline/info/">DockerHub</a> - <code>https://index.docker.io/v1/</code>
</li>
<li>
<a href="/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry">GitHub Container Registry</a> - <code>ghcr.io</code>
</li>
<li>
<a href="https://docs.microsoft.com/azure/container-registry/">Azure Container Registry</a> - <code>&lt;registry name&gt;.azurecr.io</code>
</li>
<li>
<a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/Registries.html">AWS Elastic Container Registry</a> - <code>&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com</code>
</li>
<li>
<a href="https://cloud.google.com/container-registry/docs/overview#registries">Google Cloud Container Registry</a> - <code>gcr.io</code> (US), <code>eu.gcr.io</code> (EU), <code>asia.gcr.io</code> (Asia)</li>
</ul>
<h2><a href="#debugging-private-image-registry-access">Debugging private image registry access</a></h2>
<p>If you are having trouble pulling an image from a private image registry, make sure you are able to run <code>docker login -u &lt;user&gt; -p &lt;password&gt; &lt;server&gt;</code>, using the values of the secrets defined above. If login fails, ensure that the login credentials are valid and that you have the appropriate permissions on the server to fetch a container image. If login succeeds, make sure that these values are copied appropriately into the right GitHub Codespaces secrets, either at the user, repository, or organization level and try again.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>