<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Code scanning" href="/en/code-security/code-scanning">Code scanning</a><span>/</span>
</li>
<li>
<a title="Manage code scanning" href="/en/code-security/code-scanning/managing-your-code-scanning-configuration">Manage code scanning</a><span>/</span>
</li>
<li><a title="Ruby CodeQL queries" href="/en/code-security/code-scanning/managing-your-code-scanning-configuration/ruby-built-in-queries">Ruby CodeQL queries</a></li>
</ul></nav></div>
<div>
<div><div><h1>Ruby queries for CodeQL analysis</h1></div></div>
<div>
<div><p>Explore the queries that CodeQL uses to analyze code written in Ruby when you select the <code>default</code> or the <code>security-extended</code> query suite.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div>
<p>CodeQL is available for the following repository types:</p>
<ul>
<li>Public repositories on GitHub.com, see <a href="https://github.com/github/codeql-cli-binaries/blob/main/LICENSE.md">GitHub CodeQL Terms and Conditions</a>
</li>
<li>Organization-owned repositories on GitHub Team with <a href="/en/get-started/learning-about-github/about-github-advanced-security">GitHub Code Security</a> enabled</li>
</ul>
</div></div>
</div></div>
</div>
<div><div><div>
<p>CodeQL includes many queries for analyzing Ruby code. All queries in the <code>default</code> query suite are run by default. If you choose to use the <code>security-extended</code> query suite, additional queries are run. For more information, see <a href="/en/code-security/code-scanning/managing-your-code-scanning-configuration/built-in-codeql-query-suites">CodeQL query suites</a>.</p>
<h2><a href="#built-in-queries-for-ruby-analysis">Built-in queries for Ruby analysis</a></h2>
<p>This table lists the queries available with the latest release of the CodeQL action and CodeQL CLI. For more information, see <a href="https://codeql.github.com/docs/codeql-overview/codeql-changelog/">CodeQL change logs</a> in the CodeQL documentation site.</p>
<div>

























































































































































































































































































































<table>
<thead><tr>
<th>Query name</th>
<th>Related CWEs</th>
<th>Default</th>
<th>Extended</th>
<th>Copilot Autofix</th>
</tr></thead>
<tbody>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-bad-tag-filter/">Bad HTML filtering regexp</a></th>
<td>116, 020, 185, 186</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-regex-badly-anchored-regexp/">Badly anchored regular expression</a></th>
<td>020</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-clear-text-logging-sensitive-data/">Clear-text logging of sensitive information</a></th>
<td>312, 359, 532</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-clear-text-storage-sensitive-data/">Clear-text storage of sensitive information</a></th>
<td>312, 359, 532</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-code-injection/">Code injection</a></th>
<td>094, 095, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-csrf-protection-not-enabled/">CSRF protection not enabled</a></th>
<td>352</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-csrf-protection-disabled/">CSRF protection weakened or disabled</a></th>
<td>352</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-insecure-dependency/">Dependency download using unencrypted communication channel</a></th>
<td>300, 319, 494, 829</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-unsafe-deserialization/">Deserialization of user-controlled data</a></th>
<td>502</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-insecure-download/">Download of sensitive file through insecure connection</a></th>
<td>829</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-incomplete-multi-character-sanitization/">Incomplete multi-character sanitization</a></th>
<td>020, 080, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-incomplete-hostname-regexp/">Incomplete regular expression for hostnames</a></th>
<td>020</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-incomplete-sanitization/">Incomplete string escaping or encoding</a></th>
<td>020, 080, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-incomplete-url-substring-sanitization/">Incomplete URL substring sanitization</a></th>
<td>020</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-redos/">Inefficient regular expression</a></th>
<td>1333, 730, 400</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-stack-trace-exposure/">Information exposure through an exception</a></th>
<td>209, 497</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-insecure-mass-assignment/">Insecure Mass Assignment</a></th>
<td>915</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-overly-large-range/">Overly permissive regular expression range</a></th>
<td>020</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-polynomial-redos/">Polynomial regular expression used on uncontrolled data</a></th>
<td>1333, 730, 400</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-reflected-xss/">Reflected server-side cross-site scripting</a></th>
<td>079, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-regexp-injection/">Regular expression injection</a></th>
<td>1333, 730, 400</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-sensitive-get-query/">Sensitive data read from GET request</a></th>
<td>598</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-request-forgery/">Server-side request forgery</a></th>
<td>918</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-sql-injection/">SQL query built from user-controlled sources</a></th>
<td>089</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-stored-xss/">Stored cross-site scripting</a></th>
<td>079, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-command-line-injection/">Uncontrolled command line</a></th>
<td>078, 088</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-path-injection/">Uncontrolled data used in path expression</a></th>
<td>022, 023, 036, 073, 099</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-html-constructed-from-input/">Unsafe HTML constructed from library input</a></th>
<td>079, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-shell-command-constructed-from-input/">Unsafe shell command constructed from library input</a></th>
<td>078, 088, 073</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-url-redirection/">URL redirection from remote source</a></th>
<td>601</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-non-constant-kernel-open/">Use of <code>Kernel.open</code> or <code>IO.read</code> or similar sinks with a non-constant value</a></th>
<td>078, 088, 073</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-kernel-open/">Use of <code>Kernel.open</code>, <code>IO.read</code> or similar sinks with user-controlled input</a></th>
<td>078, 088, 073</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-weak-cryptographic-algorithm/">Use of a broken or weak cryptographic algorithm</a></th>
<td>327</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-weak-sensitive-data-hashing/">Use of a broken or weak cryptographic hashing algorithm on sensitive data</a></th>
<td>327, 328, 916</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-tainted-format-string/">Use of externally-controlled format string</a></th>
<td>134</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-weak-cookie-configuration/">Weak cookie configuration</a></th>
<td>732, 1275</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-xxe/">XML external entity expansion</a></th>
<td>611, 776, 827</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-hardcoded-data-interpreted-as-code/">Hard-coded data interpreted as code</a></th>
<td>506</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-log-injection/">Log injection</a></th>
<td>117</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-regex-missing-regexp-anchor/">Missing regular expression anchor</a></th>
<td>020</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-http-to-file-access/">Network data written to file</a></th>
<td>912, 434</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-request-without-cert-validation/">Request without certificate validation</a></th>
<td>295</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<th><a href="https://codeql.github.com/codeql-query-help/ruby/rb-unsafe-code-construction/">Unsafe code constructed from library input</a></th>
<td>094, 079, 116</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div></div></div>
</div>
</div></main>
</div></body></html>