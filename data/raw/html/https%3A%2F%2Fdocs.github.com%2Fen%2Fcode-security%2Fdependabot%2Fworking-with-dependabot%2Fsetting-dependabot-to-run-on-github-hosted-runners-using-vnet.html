<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Dependabot" href="/en/code-security/dependabot">Dependabot</a><span>/</span>
</li>
<li>
<a title="Work with Dependabot" href="/en/code-security/dependabot/working-with-dependabot">Work with Dependabot</a><span>/</span>
</li>
<li><a title="Configure VNET" href="/en/code-security/dependabot/working-with-dependabot/setting-dependabot-to-run-on-github-hosted-runners-using-vnet">Configure VNET</a></li>
</ul></nav></div>
<div>
<div><div><h1>Setting up Dependabot to run on github-hosted action runners using the Azure Private Network</h1></div></div>
<div>
<div><p>You can configure an Azure Virtual Network (VNET) to run Dependabot on GitHub-hosted runners.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div><p>Users with <strong>write</strong> access</p></div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#configuring-vnet-for-dependabot-updates"><div><span>Configuring VNET for Dependabot updates</span></div></a></li>
<li><a href="#configuring-azure-resources"><div><span>Configuring Azure resources</span></div></a></li>
<li><a href="#configuring-a-vnet-injected-runner-for-dependabot-updates-in-your-enterprise"><div><span>Configuring a VNET-injected runner for Dependabot updates in your enterprise</span></div></a></li>
<li><a href="#enabling-dependabot-for-the-organization"><div><span>Enabling Dependabot for the organization</span></div></a></li>
<li><a href="#triggering-a-dependabot-run"><div><span>Triggering a Dependabot run</span></div></a></li>
<li><a href="#checking-logs-and-active-jobs-for-dependabot-updates"><div><span>Checking logs and active jobs for Dependabot updates</span></div></a></li>
<li><a href="#configuring-azure-vnet-firewall-ip-rules"><div><span>Configuring Azure VNET firewall IP rules</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#configuring-vnet-for-dependabot-updates">Configuring VNET for Dependabot updates</a></h2>
<p>This article provides step-by-step instructions for running Dependabot on GitHub-hosted runners configured with VNET. The article explains:</p>
<ul>
<li>How to create runner groups for your enterprise or organization with a VNET configuration.</li>
<li>How to create GitHub-hosted runners for Dependabot in the runner group.</li>
<li>How to enable Dependabot on large runners.</li>
<li>How to configure Azure VNET firewall IP rules.</li>
</ul>
<p>To use GitHub-hosted runners with Azure VNET, you first need to configure your Azure resources, then create a private network configuration in GitHub.</p>
<h2><a href="#configuring-azure-resources">Configuring Azure resources</a></h2>
<p>To learn how to use GitHub-hosted runners with an Azure private network, see <a href="/en/enterprise-cloud@latest/admin/configuring-settings/configuring-private-networking-for-hosted-compute-products/configuring-private-networking-for-github-hosted-runners-in-your-enterprise#configuring-your-azure-resources">Configuring your Azure resources</a>.</p>
<div>
<ul>
<li>The <code>databaseId</code> which is required in the script for configuring the Azure resources can refer to any of the following depending on whether you are configuring the resources for an enterprise or an organization:</li>
<li>The enterprise slug, which you can identify by looking at the URL for your enterprise, <code>https://github.com/enterprises/SLUG</code>, or</li>
<li>The login for the organization account, which you can identify by looking at the URL for your organization, <code>https://github.com/organizations/ORGANIZATION_LOGIN</code>.</li>
<li>The script will return the full payload for the created resource. The <code>GitHubId</code> hash value returned in the payload for the created resource is the network settings resource ID you will use in the next steps while setting up a network configuration in  GitHub</li>
</ul>
</div>
<h2><a href="#configuring-a-vnet-injected-runner-for-dependabot-updates-in-your-enterprise">Configuring a VNET-injected runner for Dependabot updates in your enterprise</a></h2>
<p>After configuring your Azure resources, you can use an Azure Virtual Network (VNET) for private networking by creating a network configuration at the organization level. Then, you can associate that network configuration to runner groups.</p>
<ol>
<li>Add a new network configuration for your enterprise. See <a href="/en/enterprise-cloud@latest/admin/configuring-settings/configuring-private-networking-for-hosted-compute-products/configuring-private-networking-for-github-hosted-runners-in-your-enterprise#1-add-a-new-network-configuration-for-your-enterprise">Add a new network configuration for your enterprise</a>
</li>
<li>Create a runner group for the enterprise and select the organizations that you want to run Dependabot updates for. See <a href="/en/enterprise-cloud@latest/admin/configuring-settings/configuring-private-networking-for-hosted-compute-products/configuring-private-networking-for-github-hosted-runners-in-your-enterprise#2-create-a-runner-group-for-your-enterprise">Create a runner group for your enterprise</a>
</li>
<li>Create and add a GitHub-hosted runner to the enterprise runner group. See <a href="/en/actions/using-github-hosted-runners/using-larger-runners/managing-larger-runners#adding-a-larger-runner-to-an-enterprise">Adding a larger runner to an enterprise</a>. Important points are as follows:
<ul>
<li>
<p>The runner name must be <strong>dependabot</strong></p>
</li>
<li>
<p>Choose a Linux x64 platform.</p>
</li>
<li>
<p>Select the suitable Ubuntu version.</p>
</li>
<li>
<p>When adding your GitHub-hosted runner to a runner group, select the runner group you created in the previous step.</p>
</li>
</ul>
<div>
<p>
Naming the GitHub-hosted runner <strong>dependabot</strong> assigns the <strong>dependabot</strong> label to the runner, which enables it to pick up jobs triggered by Dependabot on actions.</p>
</div>
</li>
</ol>
<h2><a href="#enabling-dependabot-for-the-organization">Enabling Dependabot for the organization</a></h2>
<p>You now need to enable Dependabot on <em>self-hosted runners</em> for your organization in order to enable Dependabot on large runners. See <a href="/en/code-security/dependabot/working-with-dependabot/about-dependabot-on-github-actions-runners#enabling-or-disabling-dependabot-on-larger-runners">Enabling or disabling Dependabot on larger runners</a>.</p>
<ol>
<li>
<p>In the upper-right corner of GitHub, select your profile photo, then click </p>
</li>
<li>
<p>Under your organization name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-49309/images/help/discussions/org-settings-global-nav-update.png" alt="Screenshot of the tabs in an organization's profile. The &quot;Settings&quot; tab is outlined in dark orange." width="1440" height="106"></source></picture></div>
</li>
<li>
<p>In the "Security" section of the sidebar, select the <strong>Advanced Security</strong> dropdown menu, then click <strong>Global settings</strong>.</p>
</li>
<li>
<p>Under <strong>Dependabot</strong>, select <strong>Dependabot on self-hosted runners</strong>. This step is required, as it ensures that future Dependabot jobs will run on the larger GitHub-hosted runner that has the <code>dependabot</code> name.</p>
</li>
</ol>
<h2><a href="#triggering-a-dependabot-run">Triggering a Dependabot run</a></h2>
<p>Now that you've set up private networking with VNET, you can start a Dependabot run.</p>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click the </p>
</li>
<li>
<p>In the left sidebar, click <strong>Dependency graph</strong>.
</p>
<div><picture><source><img src="/assets/cb-3959/images/help/graphs/graphs-sidebar-dependency-graph.png" alt='Screenshot of the "Dependency graph" tab. The tab is highlighted with an orange outline.' width="193" height="246"></source></picture></div>
</li>
<li>
<p>Under "Dependency graph", click <strong>Dependabot</strong>.</p>
</li>
<li>
<p>To the right of the name of manifest file you're interested in, click <strong>Recent update jobs</strong>.</p>
</li>
<li>
<p>If there are no recent update jobs for the manifest file, click <strong>Check for updates</strong> to re-run a Dependabot version updates'job and check for new updates to dependencies for that ecosystem.</p>
</li>
</ol>
<h2><a href="#checking-logs-and-active-jobs-for-dependabot-updates">Checking logs and active jobs for Dependabot updates</a></h2>
<ul>
<li>
<p>You can view the logs of the Dependabot workflow in the <strong>Actions</strong> tab of your repository. Ensure you select the Dependabot job on the left sidebar of the Actions page.</p>
<p><picture><source><img src="/assets/cb-400297/images/help/dependabot/dependabot-vnet-logs.png" alt='Example of log for a "Dependabot in vnet" workflow. The Dependabot job is highlighted with an orange outline. ' width="720" height="258"></source></picture></p>
</li>
<li>
<p>You can view the active jobs in the page containing informatuon about the runner. To access that page, click the <strong>Policies</strong> tab for the enterprise, select <strong>Actions</strong> on the left sidebar, click the <strong>Runner group</strong> tab, and select your runner.</p>
<p><picture><source><img src="/assets/cb-462465/images/help/dependabot/dependabot-vnet-active-jobs.png" alt="Screenshot showing a Dependabot runner's active jobs." width="720" height="279"></source></picture></p>
</li>
</ul>
<h2><a href="#configuring-azure-vnet-firewall-ip-rules">Configuring Azure VNET firewall IP rules</a></h2>
<p>If your Azure VNET environment is configured with a firewall with an IP allowlist, you may need to update your list of allowed IP addresses to use the GitHub-hosted runners IP addresses sourced from the meta API endpoint.</p>
<ul>
<li>
<p>GitHub provides the following public endpoint for its IP ranges:</p>
<blockquote>
<p>GET <a href="https://api.github.com/meta">https://api.github.com/meta</a></p>
</blockquote>
</li>
<li>
<p>Copy and paste the following curl command in your terminal or command prompt and replace the placeholder bearer token value with your actual value.</p>
<div>
<header><span>Bash</span><pre>      curl -L \
      -H "Accept: application/vnd.github+json" \
      -H "Authorization: Bearer YOUR-TOKEN" \
      -H "X-GitHub-Api-Version: 2022-11-28" \
      https://api.github.com/meta
</pre></header><pre><code>      curl -L \
      -H <span>"Accept: application/vnd.github+json"</span> \
      -H <span>"Authorization: Bearer YOUR-TOKEN"</span> \
      -H <span>"X-GitHub-Api-Version: 2022-11-28"</span> \
      https://api.github.com/meta
</code></pre>
</div>
</li>
<li>
<p>From the response, look for the <strong>actions</strong> key.</p>
<pre><code>    <span>"actions"</span>: [ ... ]
</code></pre>
<p>These are the IP ranges used by GitHub Actions runners, including Dependabot and hosted runners.</p>
</li>
<li>
<p>Add these IPs to your firewall allowlist.</p>
</li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>