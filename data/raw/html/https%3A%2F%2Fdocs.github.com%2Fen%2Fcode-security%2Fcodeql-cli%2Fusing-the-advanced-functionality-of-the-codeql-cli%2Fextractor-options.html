<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="CodeQL CLI" href="/en/code-security/codeql-cli">CodeQL CLI</a><span>/</span>
</li>
<li>
<a title="Advanced functionality" href="/en/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli">Advanced functionality</a><span>/</span>
</li>
<li><a title="Extractor options" href="/en/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli/extractor-options">Extractor options</a></li>
</ul></nav></div>
<div>
<div><div><h1>Extractor options</h1></div></div>
<div>
<div><p>You can use the CodeQL CLI to run CodeQL processes locally on software projects.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div>
<p>CodeQL is available for the following repository types:</p>
<ul>
<li>Public repositories on GitHub.com, see <a href="https://github.com/github/codeql-cli-binaries/blob/main/LICENSE.md">GitHub CodeQL Terms and Conditions</a>
</li>
<li>Organization-owned repositories on GitHub Team with <a href="/en/get-started/learning-about-github/about-github-advanced-security">GitHub Code Security</a> enabled</li>
</ul>
</div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-extractors"><div><span>About extractors</span></div></a></li>
<li><a href="#about-extractor-options"><div><span>About extractor options</span></div></a></li>
<li><a href="#setting-extractor-options-with-the-codeql-cli"><div><span>Setting extractor options with the CodeQL CLI</span></div></a></li>
<li><a href="#setting-extractor-options-from-files"><div><span>Setting extractor options from files</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-extractors">About extractors</a></h2>
<p>The CodeQL CLI uses special programs, called extractors, to extract information from the source code of a software system into a database that can be queried. You can customize the behavior of extractors by setting extractor configuration options through the CodeQL CLI.</p>
<h2><a href="#about-extractor-options">About extractor options</a></h2>
<p>Each extractor defines its own set of configuration options. To find out which options are available for a particular extractor, you can run <code>codeql resolve languages</code> or <code>codeql resolve extractor</code> with the <code>--format=betterjson</code> option. The <code>betterjson</code> output format provides the root paths of extractors and additional information. The output of <code>codeql resolve extractor --format=betterjson</code> will often be formatted like the following example:</p>
<pre><code><span>{</span>
    <span>"extractor_root"</span> <span>:</span> <span>"/home/user/codeql/java"</span><span>,</span>
    <span>"extractor_options"</span> <span>:</span> <span>{</span>
        <span>"option1"</span> <span>:</span> <span>{</span>
            <span>"title"</span> <span>:</span> <span>"Java extractor option 1"</span><span>,</span>
            <span>"description"</span> <span>:</span> <span>"An example string option for the Java extractor."</span><span>,</span>
            <span>"type"</span> <span>:</span> <span>"string"</span><span>,</span>
            <span>"pattern"</span> <span>:</span> <span>"[a-z]+"</span>
        <span>}</span><span>,</span>
        <span>"group1"</span> <span>:</span> <span>{</span>
            <span>"title"</span> <span>:</span> <span>"Java extractor group 1"</span><span>,</span>
            <span>"description"</span> <span>:</span> <span>"An example option group for the Java extractor."</span><span>,</span>
            <span>"type"</span> <span>:</span> <span>"object"</span><span>,</span>
            <span>"properties"</span> <span>:</span> <span>{</span>
                <span>"option2"</span> <span>:</span> <span>{</span>
                    <span>"title"</span> <span>:</span> <span>"Java extractor option 2"</span><span>,</span>
                    <span>"description"</span> <span>:</span> <span>"An example array option for the Java extractor"</span><span>,</span>
                    <span>"type"</span> <span>:</span> <span>"array"</span><span>,</span>
                    <span>"pattern"</span> <span>:</span> <span>"[1-9][0-9]*"</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre>
<p>The extractor option names and descriptions are listed under <code>extractor_options</code>. Each option may contain the following fields:</p>
<ul>
<li>
<code>title</code> (required): The title of the option</li>
<li>
<code>description</code> (required): The description of the option</li>
<li>
<code>type</code> (required): The type of the option, which can be
<ul>
<li>
<code>string</code>: indicating that the option can have a single string value</li>
<li>
<code>array</code>: indicating that the option can have a sequence of string values</li>
<li>
<code>object</code>: indicating that it is not an option itself, but a grouping that may contain other options and option groups</li>
</ul>
</li>
<li>
<code>pattern</code> (optional): The regular expression patterns that all values of the option should match. Note that the extractor may impose additional constraints on option values that are not or cannot be expressed in this regular expression pattern. Such constraints, if they exist, would be explained under the description field.</li>
<li>
<code>properties</code> (optional): A map from extractor option names in the option group to the corresponding extractor option descriptions. This field can only be present for option groups. For example, options of <code>object</code> type.</li>
</ul>
<p>In the example above, the extractor declares two options:</p>
<ul>
<li>
<code>option1</code> is a <code>string</code> option with value matching <code>[a-z]+</code>
</li>
<li>
<code>group1.option2</code> is an <code>array</code> option with values matching <code>[1-9][0-9]\*</code>
</li>
</ul>
<h2><a href="#setting-extractor-options-with-the-codeql-cli">Setting extractor options with the CodeQL CLI</a></h2>
<p>The CodeQL CLI supports setting extractor options in subcommands that directly or indirectly invoke extractors. These commands are:</p>
<ul>
<li><code>codeql database create</code></li>
<li><code>codeql database start-tracing</code></li>
<li><code>codeql database trace-command</code></li>
<li><code>codeql database index-files</code></li>
</ul>
<p>When running these subcommands, you can set extractor options with the <code>--extractor-option</code> CLI option. For example:</p>
<ul>
<li><code>codeql database create --extractor-option java.option1=abc ...</code></li>
<li><code>codeql database start-tracing --extractor-option java.group1.option2=102 ...</code></li>
</ul>
<p><code>--extractor-option</code> requires exactly one argument of the form <code>extractor_option_name=extractor_option_value</code>. <code>extractor_option_name</code> is the name of the extractor (in this example, <code>java</code>) followed by a period and then the name of the extractor option (in this example, either <code>option1</code> or <code>group1.option2</code>). <code>extractor_option_value</code> is the value being assigned to the extractor option. The value must match the regular expression pattern of the extractor option (if it exists), and it must not contain newline characters.</p>
<p>Using <code>--extractor-option</code> to assign an extractor option that does not exist is an error.</p>
<p>The CodeQL CLI accepts multiple <code>--extractor-option</code> options in the same invocation. If you set a <code>string</code> extractor option multiple times, the last option value overwrites all previous ones. If you set an array extractor option multiple times, all option values are concatenated in order.</p>
<p>You can also specify extractor option names without the extractor name. For example:</p>
<ul>
<li><code>codeql database create --extractor-option option1=abc ...</code></li>
<li><code>codeql database start-tracing --extractor-option group1.option2=102 ...</code></li>
</ul>
<p>If you do not specify an extractor name, the extractor option settings will apply to all extractors that declare an option with the given name. In the above example, the first command would set the extractor option <code>option1</code> to <code>abc</code> for the <code>java</code> extractor and every extractor that has an option of <code>option1</code>, for example the <code>cpp</code> extractor, if the <code>option1</code> extractor option exists for that extractor.</p>
<h2><a href="#setting-extractor-options-from-files">Setting extractor options from files</a></h2>
<p>You can also set extractor options through a file. The CodeQL CLI subcommands that accept <code>--extractor-option</code> also accept <code>--extractor-options-file</code>, which has a required argument of the path to a YAML file (with extension <code>.yaml</code> or <code>.yml</code>) or a JSON file (with extension <code>.json</code>). For example:</p>
<ul>
<li><code>codeql database create --extractor-options-file options.yml ...</code></li>
<li><code>codeql database start-tracing --extractor-options-file options.json ...</code></li>
</ul>
<p>Each option file contains a tree structure of nested maps. At the root is an extractor map key, and beneath it are map keys that correspond to extractor names. Starting at the third level, there are extractor options and option groups.</p>
<p>In JSON:</p>
<pre><code><span>{</span>
     <span>"extractor"</span> <span>:</span> <span>{</span>
        <span>"java"</span><span>:</span> <span>{</span>
            <span>"option1"</span> <span>:</span> <span>"abc"</span><span>,</span>
            <span>"group1"</span> <span>:</span> <span>{</span>
                <span>"option2"</span> <span>:</span> <span>[</span> <span>102</span> <span>]</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
</code></pre>
<p>In YAML:</p>
<pre><code><span>extractor:</span>
    <span>java:</span>
        <span>option1:</span> <span>"abc"</span>
        <span>group1:</span>
            <span>option2:</span> [ <span>102</span> ]
</code></pre>
<p>The value for a <code>string</code> extractor option must be a string or a number (which will be converted to a string before further processing).</p>
<p>The value for an <code>array</code> extractor option must be an array of strings or numbers.</p>
<p>The value for an option group (of type <code>object</code>) must be a map, which may contain nested extractor options and option groups.</p>
<p>Each extractor option value must match the regular expression pattern of the extractor option (if it exists), and it must not contain newline characters.</p>
<p>Assigning an extractor option that does not exist is an error. You can make the CodeQL CLI ignore unknown extractor options by using a special <code>__allow_unknown_properties</code> Boolean field. For example, the following option file asks the CodeQL CLI to ignore all unknown extractor options and option groups under <code>group1</code>:</p>
<pre><code><span>extractor:</span>
    <span>java:</span>
        <span>option1:</span> <span>"abc"</span>
        <span>group1:</span>
            <span>__allow_unknown_properties:</span> <span>true</span>
            <span>option2:</span> [ <span>102</span> ]
</code></pre>
<p>You can specify <code>--extractor-options-file</code> multiple times. The extractor option assignments are processed in the following order:</p>
<ol>
<li>All extractor option files specified by <code>--extractor-options-file</code> are processed in the order they appear on the command line, then</li>
<li>All extractor option assignments specified by <code>--extractor-option</code> are processed in the order they appear on the command line</li>
</ol>
<p>The same rules govern what happens when the same extractor option is set multiple times, regardless of whether the assignments are done using <code>--extractor-option</code>, using <code>--extractor-options-file</code>, or some combination of the two. If you set a <code>string</code> extractor option multiple times, the last option value overwrites all previous values. If you set an <code>array</code> extractor option multiple times, all option values are concatenated in order.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>