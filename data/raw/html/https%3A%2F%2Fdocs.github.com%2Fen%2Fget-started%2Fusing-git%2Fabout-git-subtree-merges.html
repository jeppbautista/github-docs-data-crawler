<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Get started" href="/en/get-started">Get started</a><span>/</span>
</li>
<li>
<a title="Using Git" href="/en/get-started/using-git">Using Git</a><span>/</span>
</li>
<li><a title="About Git subtree merges" href="/en/get-started/using-git/about-git-subtree-merges">About Git subtree merges</a></li>
</ul></nav></div>
<div>
<div><div><h1>About Git subtree merges</h1></div></div>
<div>
<div><p>If you need to manage multiple projects within a single repository, you can use a <em>subtree merge</em> to handle all the references.</p></div>
<div>
<h2>Platform navigation</h2>
<nav><ul>
<li><a href="?platform=mac"><span>Mac</span></a></li>
<li><a href="?platform=windows"><span>Windows</span></a></li>
<li><a href="?platform=linux"><span>Linux</span></a></li>
</ul></nav>
</div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-subtree-merges"><div><span>About subtree merges</span></div></a></li>
<li><a href="#setting-up-the-empty-repository-for-a-subtree-merge"><div><span>Setting up the empty repository for a subtree merge</span></div></a></li>
<li><a href="#adding-a-new-repository-as-a-subtree"><div><span>Adding a new repository as a subtree</span></div></a></li>
<li><a href="#synchronizing-with-updates-and-changes"><div><span>Synchronizing with updates and changes</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-subtree-merges">About subtree merges</a></h2>
<p>Typically, a subtree merge is used to contain a repository within a repository. The "subrepository" is stored in a folder of the main repository.</p>
<p>The best way to explain subtree merges is to show by example. We will:</p>
<ul>
<li>Make an empty repository called <code>test</code> that represents our project.</li>
<li>Merge another repository into it as a subtree called <code>Spoon-Knife</code>.</li>
<li>The <code>test</code> project will use that subproject as if it were part of the same repository.</li>
<li>Fetch updates from <code>Spoon-Knife</code> into our <code>test</code> project.</li>
</ul>
<h2><a href="#setting-up-the-empty-repository-for-a-subtree-merge">Setting up the empty repository for a subtree merge</a></h2>
<ol>
<li>
<p>Open <span>Terminal</span><span>Terminal</span><span>Git Bash</span>.</p>
</li>
<li>
<p>Create a new directory and navigate to it.</p>
<pre><code>mkdir test
cd test
</code></pre>
</li>
<li>
<p>Initialize a new Git repository.</p>
<pre><code><span>$ </span><span>git init</span>
<span>&gt; </span><span>Initialized empty Git repository <span>in</span> /Users/octocat/tmp/test/.git/</span>
</code></pre>
</li>
<li>
<p>Create and commit a new file.</p>
<pre><code><span>$ </span><span><span>touch</span> .gitignore</span>
<span>$ </span><span>git add .gitignore</span>
<span>$ </span><span>git commit -m <span>"initial commit"</span></span>
<span>&gt; </span><span>[main (root-commit) 3146c2a] initial commit</span>
<span>&gt; </span><span> 0 files changed, 0 insertions(+), 0 deletions(-)</span>
<span>&gt; </span><span> create mode 100644 .gitignore</span>
</code></pre>
</li>
</ol>
<h2><a href="#adding-a-new-repository-as-a-subtree">Adding a new repository as a subtree</a></h2>
<ol>
<li>
<p>Add a new remote URL pointing to the separate project that we're interested in.</p>
<pre><code><span>$ </span><span>git remote add -f spoon-knife https://github.com/octocat/Spoon-Knife.git</span>
<span>&gt; </span><span>Updating spoon-knife</span>
<span>&gt; </span><span>warning: no common commits</span>
<span>&gt; </span><span>remote: Counting objects: 1732, <span>done</span>.</span>
<span>&gt; </span><span>remote: Compressing objects: 100% (750/750), <span>done</span>.</span>
<span>&gt; </span><span>remote: Total 1732 (delta 1086), reused 1558 (delta 967)</span>
<span>&gt; </span><span>Receiving objects: 100% (1732/1732), 528.19 KiB | 621 KiB/s, <span>done</span>.</span>
<span>&gt; </span><span>Resolving deltas: 100% (1086/1086), <span>done</span>.</span>
<span>&gt; </span><span>From https://github.com/octocat/Spoon-Knife</span>
<span>&gt; </span><span> * [new branch]      main     -&gt; Spoon-Knife/main</span>
</code></pre>
</li>
<li>
<p>Merge the <code>Spoon-Knife</code> project into the local Git project. This doesn't change any of your files locally, but it does prepare Git for the next step.</p>
<p>If you're using Git 2.9 or above:</p>
<pre><code><span>$ </span><span>git merge -s ours --no-commit --allow-unrelated-histories spoon-knife/main</span>
<span>&gt; </span><span>Automatic merge went well; stopped before committing as requested</span>
</code></pre>
<p>If you're using Git 2.8 or below:</p>
<pre><code><span>$ </span><span>git merge -s ours --no-commit spoon-knife/main</span>
<span>&gt; </span><span>Automatic merge went well; stopped before committing as requested</span>
</code></pre>
</li>
<li>
<p>Create a new directory called <strong>spoon-knife</strong>, and copy the Git history of the <code>Spoon-Knife</code> project into it.</p>
<pre><code><span>$ </span><span>git read-tree --prefix=spoon-knife/ -u spoon-knife/main</span>
<span>&gt; </span><span>fatal: refusing to merge unrelated histories</span>
</code></pre>
</li>
<li>
<p>Commit the changes to keep them safe.</p>
<pre><code><span>$ </span><span>git commit -m <span>"Subtree merged in spoon-knife"</span></span>
<span>&gt; </span><span>[main fe0ca25] Subtree merged <span>in</span> spoon-knife</span>
</code></pre>
</li>
</ol>
<p>Although we've only added one subproject, any number of subprojects can be incorporated into a Git repository.</p>
<div>
<p>
If you create a fresh clone of the repository in the future, the remotes you've added will not be created for you. You will have to add them again using <a href="/en/get-started/git-basics/managing-remote-repositories">the <code>git remote add</code> command</a>.</p>
</div>
<h2><a href="#synchronizing-with-updates-and-changes">Synchronizing with updates and changes</a></h2>
<p>When a subproject is added, it is not automatically kept in sync with the upstream changes. You will need to update the subproject with the following command:</p>
<pre><code>git pull -s subtree REMOTE-NAME BRANCH-NAME
</code></pre>
<p>For the example above, this would be:</p>
<pre><code>git pull -s subtree spoon-knife main
</code></pre>
<h2><a href="#further-reading">Further reading</a></h2>
<ul>
<li><a href="https://git-scm.com/book/en/v2/Git-Tools-Advanced-Merging">The "Advanced Merging" chapter from the <em>Pro Git</em> book</a></li>
<li><a href="https://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html">How to use the subtree merge strategy</a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>