<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="CodeQL for VS Code" href="/en/code-security/codeql-for-vs-code">CodeQL for VS Code</a><span>/</span>
</li>
<li>
<a title="Advanced functionality" href="/en/code-security/codeql-for-vs-code/using-the-advanced-functionality-of-the-codeql-for-vs-code-extension">Advanced functionality</a><span>/</span>
</li>
<li><a title="Test CodeQL queries" href="/en/code-security/codeql-for-vs-code/using-the-advanced-functionality-of-the-codeql-for-vs-code-extension/testing-codeql-queries-in-vs-code">Test CodeQL queries</a></li>
</ul></nav></div>
<div>
<div><div><h1>Testing CodeQL queries in Visual Studio Code</h1></div></div>
<div><div><p>You can run unit tests for CodeQL queries using the Visual Studio Code extension.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-testing-queries-in-vs-code"><div><span>About testing queries in VS Code</span></div></a></li>
<li><a href="#testing-the-results-of-your-queries"><div><span>Testing the results of your queries</span></div></a></li>
<li><a href="#monitoring-the-performance-of-your-queries"><div><span>Monitoring the performance of your queries</span></div></a></li>
<li><a href="#next-steps"><div><span>Next steps</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-testing-queries-in-vs-code">About testing queries in VS Code</a></h2>
<p>To ensure that your CodeQL queries produce the expected results, you can run tests that compare the expected query results with the actual results.</p>
<p>The CodeQL extension automatically registers itself with the "Testing" view. This view displays all tests found in your current workspace and provides a UI for exploring and running tests in your workspace.</p>
<p>For more information about creating CodeQL tests, see <a href="/en/code-security/codeql-cli/using-the-codeql-cli/testing-custom-queries">Testing custom queries</a>.</p>
<p>To see more detailed output from running unit tests, open the CodeQL Tests log. For information, see <a href="/en/code-security/codeql-for-vs-code/troubleshooting-codeql-for-vs-code/accessing-logs">Accessing logs</a>.</p>
<h2><a href="#testing-the-results-of-your-queries">Testing the results of your queries</a></h2>
<ol>
<li>
<p>In Visual Studio Code, open the "Testing" view in the sidebar.</p>
</li>
<li>
<p>To run a specific test, hover over the file or folder name and click the play button. To run all tests in your workspace, click the play button at the top of the view. If a test takes too long to run, you can click the stop button at the top of the view to cancel the test.</p>
<div><picture><source><img src="/assets/cb-44333/images/help/security/codeql-for-vs-code-run-all-tests.png" alt='Screenshot of the "Testing" view, with the "Run Test" button (to run all tests) outlined in dark orange.'></source></picture></div>
</li>
<li>
<p>The icons show whether a test passed or failed. If it failed, click the test in the "Test Results" to display the differences between the expected output and the actual output.</p>
<div><picture><source><img src="/assets/cb-125782/images/help/security/codeql-for-vs-code-test-output.png" alt='Screenshot of the "Test Results" view displaying the differences between the expected output and actual output for a test.' width="1363" height="726"></source></picture></div>
</li>
<li>
<p>Compare the results. If you want to update the test with the actual output, right-click the test in the "Testing" view and click <strong>Accept Test Output</strong>.</p>
</li>
</ol>
<h2><a href="#monitoring-the-performance-of-your-queries">Monitoring the performance of your queries</a></h2>
<p>Query performance is important when you want to run a query on large databases, or as part of your continuous integration system.</p>
<p>If you want to examine query performance, enable the "Running Queries: Debug" setting to include timing and tuple counts. This will then be shown in the logs in the CodeQL "Query Server" tab of the "Output" view. The tuple count is useful because it indicates the size of the <a href="https://codeql.github.com/docs/ql-language-reference/predicates/#predicates">predicates</a> computed by the query. For more information about changing settings, see <a href="/en/code-security/codeql-for-vs-code/using-the-advanced-functionality-of-the-codeql-for-vs-code-extension/customizing-settings#configuring-settings-for-running-queries-locally">Customizing settings</a>.</p>
<p>When a query is evaluated, the query server caches the predicates that it calculates. So when you want to compare the performance of two evaluations, you should run <strong>CodeQL: Clear Cache</strong> to clear the query server's cache before each run. This ensures that you're comparing equivalent data.</p>
<p>For more information about monitoring the performance of your CodeQL queries, see <a href="https://codeql.github.com/docs/writing-codeql-queries/troubleshooting-query-performance/#troubleshooting-query-performance">Troubleshooting query performance</a> and <a href="https://codeql.github.com/docs/ql-language-reference/evaluation-of-ql-programs/#evaluation-of-ql-programs">Evaluation of QL programs</a> in the CodeQL documentation.</p>
<h2><a href="#next-steps">Next steps</a></h2>
<p>When you are sure that your query finds the results you want to identify, you can use variant analysis to run it at scale. For information on running analysis at scale across many CodeQLdatabases, see <a href="/en/code-security/codeql-for-vs-code/getting-started-with-codeql-for-vs-code/running-codeql-queries-at-scale-with-multi-repository-variant-analysis">Running CodeQL queries at scale with multi-repository variant analysis</a>.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>