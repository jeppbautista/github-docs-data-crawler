<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Apps" href="/en/apps">Apps</a><span>/</span>
</li>
<li>
<a title="OAuth apps" href="/en/apps/oauth-apps">OAuth apps</a><span>/</span>
</li>
<li>
<a title="Building OAuth apps" href="/en/apps/oauth-apps/building-oauth-apps">Building OAuth apps</a><span>/</span>
</li>
<li><a title="Best practices" href="/en/apps/oauth-apps/building-oauth-apps/best-practices-for-creating-an-oauth-app">Best practices</a></li>
</ul></nav></div>
<div>
<div><div><h1>Best practices for creating an OAuth app</h1></div></div>
<div><div><p>Follow these best practices to improve the security and performance of your OAuth app.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#use-a-github-app-instead"><div><span>Use a GitHub App instead</span></div></a></li>
<li><a href="#use-minimal-scopes"><div><span>Use minimal scopes</span></div></a></li>
<li><a href="#authorize-thoroughly-and-durably"><div><span>Authorize thoroughly and durably</span></div></a></li>
<li><a href="#secure-your-apps-credentials"><div><span>Secure your app's credentials</span></div></a></li>
<li><a href="#use-the-appropriate-token-type"><div><span>Use the appropriate token type</span></div></a></li>
<li><a href="#make-a-plan-for-handling-security-breaches"><div><span>Make a plan for handling security breaches</span></div></a></li>
<li><a href="#conduct-regular-vulnerability-scans"><div><span>Conduct regular vulnerability scans</span></div></a></li>
<li><a href="#choose-an-appropriate-environment"><div><span>Choose an appropriate environment</span></div></a></li>
<li><a href="#use-services-in-a-secure-manner"><div><span>Use services in a secure manner</span></div></a></li>
<li><a href="#add-logging-and-monitoring"><div><span>Add logging and monitoring</span></div></a></li>
<li><a href="#enable-data-deletion"><div><span>Enable data deletion</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#use-a-github-app-instead">Use a GitHub App instead</a></h2>
<p>If possible, consider using a GitHub App instead of an OAuth app. In general, GitHub Apps are preferred over OAuth apps. GitHub Apps use fine-grained permissions, give the user more control over which repositories the app can access, and use short-lived tokens. These properties can harden the security of your app by limiting the damage that could be done if your app's credentials are leaked.</p>
<p>Similar to OAuth apps, GitHub Apps can still use OAuth 2.0 and generate a type of OAuth token (called a user access token) and take actions on behalf of a user. However, GitHub Apps can also act independently of a user.</p>
<p>For more information about GitHub Apps, see <a href="/en/apps/creating-github-apps/setting-up-a-github-app/about-creating-github-apps">About creating GitHub Apps</a>.</p>
<p>For more information about migrating an existing OAuth app to a GitHub App, see <a href="/en/apps/creating-github-apps/guides/migrating-oauth-apps-to-github-apps">Migrating OAuth apps to GitHub Apps</a>.</p>
<h2><a href="#use-minimal-scopes">Use minimal scopes</a></h2>
<p>Your OAuth app should only request the scopes that the app needs to perform its intended functionality. If any tokens for your app become compromised, this will limit the amount of damage that can occur. For more information, see <a href="/en/apps/oauth-apps/building-oauth-apps/authorizing-oauth-apps">Authorizing OAuth apps</a>.</p>
<h2><a href="#authorize-thoroughly-and-durably">Authorize thoroughly and durably</a></h2>
<p>After signing in a user, app developers must take additional steps to ensure that the user is meant to have access to the data in your system. Each sign in requires fresh checks around their memberships, access, and their current SSO status.</p>
<h3><a href="#use-the-durable-unique-id-to-store-the-user">Use the durable, unique <code>id</code> to store the user</a></h3>
<p>When a user signs in and performs actions in your application, you have to remember which user took that action in order to grant them access to the same resources the next time they sign in.</p>
<p>To store users in your database correctly, always use the <code>id</code> of the user. This value will never change for the user or be used to point to a different user, so it ensures you are providing access to the user you intend. You can find a user's <code>id</code> with the <code>GET /user</code> REST API endpoint. See <a href="/en/rest/users/users#get-a-user">REST API endpoints for users</a>.</p>
<p>If you store references to repositories, organizations, and enterprises, use their <code>id</code> as well to ensure your links to them remain accurate.</p>
<p><em>Never</em> use identifiers that can change over time, including user handles, organization slugs, or email addresses.</p>
<h3><a href="#validate-organization-access-for-every-new-authentication">Validate organization access for every new authentication</a></h3>
<p>When you sign in a user, you should track which organizations the user's token is authorized for. This can change over time after sign in as users are removed from organizations. If an organization uses SAML SSO and a user has not performed SAML SSO, the user access token will not have access to that organization. You should use the <code>GET /user/installations</code> REST API endpoint regularly to verify which organizations a user access token has access to. If the user is not authorized to access an organization, you should prevent their access to organization owned data within your own application until they perform SAML SSO or rejoin the organization. For more information, see <a href="/en/rest/apps/installations#list-app-installations-accessible-to-the-user-access-token">REST API endpoints for GitHub App installations</a>.</p>
<h3><a href="#store-user-data-with-organizational-and-enterprise-contexts">Store user data with organizational and enterprise contexts</a></h3>
<p>Beyond tracking user identity via the <code>id</code> field, you should retain data for the organization or enterprise each user is operating under. This will help ensure you don't leak sensitive information if a user switches roles.</p>
<p>For example:</p>
<ol>
<li>A user is in the <code>Mona</code> organization, which requires SAML SSO, and signs into your app after performing SSO. Your app now has access to whatever the user does within <code>Mona</code>.</li>
<li>The user pulls a bunch of code out of a repository in <code>Mona</code> and saves it in your app for analysis.</li>
<li>Later, the user switches jobs, and is removed from the <code>Mona</code> organization.</li>
</ol>
<p>When the user accesses your app, can they still see the code and analysis from the <code>Mona</code> organization in their user account?</p>
<p>This is why it's critical to track the source of the data that your app is saving. Otherwise, your app is a data protection threat for organizations, and they're likely to ban your app if they can't trust that your app correctly protects their data.</p>
<h3><a href="#verify-a-users-access-to-your-app">Verify a user's access to your app</a></h3>
<p>Your OAuth app can be accessed by users outside your organization or enterprise. If you intend an app to be used only by members of your organization or enterprise, you should check the user's membership status when the user signs in to your app.</p>
<p>To find the list of organizations a user is a member of, you can use the "List organizations for the authenticated user" endpoint. Then you can validate this list against a list of approved organizations for your app. For more information, see <a href="/en/rest/orgs/orgs#list-organizations-for-the-authenticated-user">REST API endpoints for organizations</a>.</p>
<h2><a href="#secure-your-apps-credentials">Secure your app's credentials</a></h2>
<p>With a client secret, your app can authorize a user and generate user access tokens. These tokens can be used to make API requests on behalf of a user.</p>
<p>You must store your app's client secret and any generated tokens securely. The storage mechanism depends on your integrations architecture and the platform that it runs on. In general, you should use a storage mechanism that is intended to store sensitive data on the platform that you are using.</p>
<h3><a href="#client-secrets">Client secrets</a></h3>
<p>If your app is a website or web app, consider storing your client secret in a key vault, such as <a href="https://azure.microsoft.com/products/key-vault">Azure Key Vault</a>, or as an encrypted environment variable or secret on your server.</p>
<p>If your app is a native client, client-side app, or runs on a user device (as opposed to running on your servers), you cannot secure your client secret. You should use caution if you plan to gate access to your own services based on tokens generated by your app, because anyone can access the client secret to generate a token.</p>
<h3><a href="#user-access-tokens">User access tokens</a></h3>
<p>If your app is a website or web app, you should encrypt the tokens on your back end and ensure there is security around the systems that can access the tokens. Consider storing refresh tokens in a separate place from active access tokens.</p>
<p>If your app is a native client, client-side app, or runs on a user device (as opposed to running on your servers), you may not be able to secure tokens as well as an app that runs on your servers. You should store tokens via the mechanism recommended for your app's platform, and keep in mind that the storage mechanism may not be fully secure.</p>
<h2><a href="#use-the-appropriate-token-type">Use the appropriate token type</a></h2>
<p>OAuth apps can generate user access tokens in order to make authenticated API requests. Your app should never use a personal access token or GitHub password to authenticate.</p>
<h2><a href="#make-a-plan-for-handling-security-breaches">Make a plan for handling security breaches</a></h2>
<p>You should have a plan in place so that you can handle any security breaches in a timely manner.</p>
<p>In the event that your app's client secret is compromised, you will need to generate a new secret, update your app to use the new secret, and delete your old secret.</p>
<p>In the event that user access tokens are compromised, you should immediately revoke these tokens. For more information, see <a href="/en/rest/apps/oauth-applications#delete-an-app-token">REST API endpoints for OAuth authorizations</a>.</p>
<h2><a href="#conduct-regular-vulnerability-scans">Conduct regular vulnerability scans</a></h2>
<p>You should conduct regular vulnerability scans for your app. For example, you might set up code scanning and secret scanning for the repository that hosts your app's code. For more information, see <a href="/en/code-security/code-scanning/introduction-to-code-scanning/about-code-scanning">About code scanning</a> and <a href="/en/code-security/secret-scanning/introduction/about-secret-scanning">About secret scanning</a>.</p>
<h2><a href="#choose-an-appropriate-environment">Choose an appropriate environment</a></h2>
<p>If your app runs on a server, verify that your server environment is secure and that it can handle the volume of traffic that you expect for your app.</p>
<h2><a href="#use-services-in-a-secure-manner">Use services in a secure manner</a></h2>
<p>If your app uses third-party services, they should be used in a secure manner:</p>
<ul>
<li>Any services used by your app should have a unique login and password.</li>
<li>Apps should not share service accounts such as email or database services to manage your SaaS service.</li>
<li>Only employees with administrative duties should have admin access to the infrastructure that hosts your app.</li>
</ul>
<h2><a href="#add-logging-and-monitoring">Add logging and monitoring</a></h2>
<p>Consider adding logging and monitoring capabilities for your app. A security log could include:</p>
<ul>
<li>Authentication and authorization events</li>
<li>Service configuration changes</li>
<li>Object reads and writes</li>
<li>User and group permission changes</li>
<li>Elevation of role to admin</li>
</ul>
<p>Your logs should use consistent timestamping for each event and should record the users, IP addresses, or hostnames for all logged events.</p>
<h2><a href="#enable-data-deletion">Enable data deletion</a></h2>
<p>If your app is available to other users, you should give users a way to delete their data. Users should not need to email or call a support person in order to delete their data.</p>
<h2><a href="#further-reading">Further reading</a></h2>
<ul>
<li><a href="/en/apps/publishing-apps-to-github-marketplace/creating-apps-for-github-marketplace/security-best-practices-for-apps">Security best practices for apps on GitHub Marketplace</a></li>
<li><a href="/en/apps/publishing-apps-to-github-marketplace/creating-apps-for-github-marketplace/customer-experience-best-practices-for-apps">Customer experience best practices for apps</a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>