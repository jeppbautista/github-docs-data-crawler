<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="GitHub Actions" href="/en/actions">GitHub Actions</a><span>/</span>
</li>
<li>
<a title="Security" href="/en/actions/security-for-github-actions">Security</a><span>/</span>
</li>
<li>
<a title="Artifact attestations" href="/en/actions/security-for-github-actions/using-artifact-attestations">Artifact attestations</a><span>/</span>
</li>
<li><a title="Verifying attestations offline" href="/en/actions/security-for-github-actions/using-artifact-attestations/verifying-attestations-offline">Verifying attestations offline</a></li>
</ul></nav></div>
<div>
<div><div><h1>Verifying attestations offline</h1></div></div>
<div><div><p>Artifact attestations can be verified without an internet connection.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#introduction"><div><span>Introduction</span></div></a></li>
<li><a href="#step-1-download-attestation-bundle"><div><span>Step 1: Download attestation bundle</span></div></a></li>
<li><a href="#step-2-download-trusted-roots"><div><span>Step 2: Download trusted roots</span></div></a></li>
<li><a href="#step-3-perform-offline-verification"><div><span>Step 3: Perform offline verification</span></div></a></li>
<li><a href="#conclusion"><div><span>Conclusion</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#introduction">Introduction</a></h2>
<p>Artifact attestations are a great way to create unfalsifiable provenance and integrity guarantees for the software you build.</p>
<p>By default, attestations are stored in GitHub's attestation API, which <code>gh attestation verify</code> will query when you go to verify your attestation. That command will also contact GitHub's servers to check for updated key material to use to verify the attestation.</p>
<p>This command can work without internet connectivity, but you need to supply the attestation bundle and the key material in the trusted root manually.</p>
<p>Before starting this guide, you should be building with generating artifact attestations. See <a href="/en/actions/security-guides/using-artifact-attestations-to-establish-provenance-for-builds">Using artifact attestations to establish provenance for builds</a>.</p>
<h2><a href="#step-1-download-attestation-bundle">Step 1: Download attestation bundle</a></h2>
<p>First, get the attestation bundle from the attestation API.</p>
<p>You can do so with the following command from a machine that is online:</p>
<div>
<header><span>Bash</span><pre>gh attestation download PATH/TO/YOUR/BUILD/ARTIFACT-BINARY -R ORGANIZATION_NAME/REPOSITORY_NAME
</pre></header><pre><code>gh attestation download PATH/TO/YOUR/BUILD/ARTIFACT-BINARY -R ORGANIZATION_NAME/REPOSITORY_NAME
</code></pre>
</div>
<p>Here is example output from that command:</p>
<pre><code>Wrote attestations to file sha256:ae57936def59bc4c75edd3a837d89bcefc6d3a5e31d55a6fa7a71624f92c3c3b.jsonl.
Any previous content has been overwritten

The trusted metadata is now available at sha256:ae57936def59bc4c75edd3a837d89bcefc6d3a5e31d55a6fa7a71624f92c3c3b.jsonl
</code></pre>
<h2><a href="#step-2-download-trusted-roots">Step 2: Download trusted roots</a></h2>
<p>Next, get the key material from the trusted roots.</p>
<p>Artifact attestations uses the Sigstore public good instance for public repositories, and GitHub's Sigstore instance for private repositories. You can use one command to get both trusted roots:</p>
<div>
<header><span>Bash</span><pre>gh attestation trusted-root &gt; trusted_root.jsonl
</pre></header><pre><code>gh attestation trusted-root &gt; trusted_root.jsonl
</code></pre>
</div>
<h3><a href="#updating-trusted-root-information-in-an-offline-environment">Updating trusted root information in an offline environment</a></h3>
<p>It's best practice to generate a new <code>trusted_root.jsonl</code> file any time you are importing new signed material into your offline environment.</p>
<p>The key material in <code>trusted_root.jsonl</code> does not have a built-in expiration date, so anything signed before you generate the trusted root file will continue to successfully verify. Anything signed after the file is generated will verify until that Sigstore instance rotates its key material, which typically happens a few times per year. You will not know if key material has been revoked since you last generated the trusted root file.</p>
<h2><a href="#step-3-perform-offline-verification">Step 3: Perform offline verification</a></h2>
<p>Now, you are ready to verify the artifact offline.</p>
<p>You should import into your offline environment:</p>
<ul>
<li>GitHub CLI</li>
<li>Your artifact</li>
<li>The bundle file</li>
<li>The trusted root file</li>
</ul>
<p>You can then perform offline verification with the following command:</p>
<div>
<header><span>Bash</span><pre>gh attestation verify PATH/TO/YOUR/BUILD/ARTIFACT-BINARY -R ORGANIZATION_NAME/REPOSITORY_NAME --bundle sha256:ae57936def59bc4c75edd3a837d89bcefc6d3a5e31d55a6fa7a71624f92c3c3b.jsonl --custom-trusted-root trusted_root.jsonl
</pre></header><pre><code>gh attestation verify PATH/TO/YOUR/BUILD/ARTIFACT-BINARY -R ORGANIZATION_NAME/REPOSITORY_NAME --bundle sha256:ae57936def59bc4c75edd3a837d89bcefc6d3a5e31d55a6fa7a71624f92c3c3b.jsonl --custom-trusted-root trusted_root.jsonl
</code></pre>
</div>
<h2><a href="#conclusion">Conclusion</a></h2>
<p>You are now verifying artifact attestations in an offline environment. We recommend importing a new trusted root whenever you are introducing new signed artifacts to your offline environment.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>