<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Dependabot" href="/en/code-security/dependabot">Dependabot</a><span>/</span>
</li>
<li>
<a title="Work with Dependabot" href="/en/code-security/dependabot/working-with-dependabot">Work with Dependabot</a><span>/</span>
</li>
<li><a title="Configure ARC" href="/en/code-security/dependabot/working-with-dependabot/setting-dependabot-to-run-on-self-hosted-runners-using-arc">Configure ARC</a></li>
</ul></nav></div>
<div>
<div><div><h1>Setting up Dependabot to run on self-hosted action runners using the Actions Runner Controller</h1></div></div>
<div>
<div><p>You can configure the Actions Runner Controller to run Dependabot on self-hosted runners.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div><p>Users with <strong>write</strong> access</p></div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#working-with-the-actions-runner-controller-arc"><div><span>Working with the Actions Runner Controller (ARC)</span></div></a></li>
<li><a href="#what-is-arc"><div><span>What is ARC?</span></div></a></li>
<li><a href="#dependabot-on-arc"><div><span>Dependabot on ARC</span></div></a></li>
<li><a href="#setting-up-arc-for-dependabot-on-your-local-environment"><div><span>Setting up ARC for Dependabot on your Local environment</span></div></a></li>
<li><a href="#triggering-a-dependabot-run"><div><span>Triggering a Dependabot run</span></div></a></li>
<li><a href="#viewing-the-generated-arc-runners"><div><span>Viewing the generated ARC runners</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#working-with-the-actions-runner-controller-arc">Working with the Actions Runner Controller (ARC)</a></h2>
<p>This article provides step-by-step instructions for setting up ARC on a Kubernetes cluster and configuring Dependabot to run on self-hosted action runners. The article:</p>
<ul>
<li>Contains an overview of the ARC and Dependabot integration.</li>
<li>Provides detailed installation and configuration steps using helm scripts.</li>
</ul>
<h2><a href="#what-is-arc">What is ARC?</a></h2>
<p>The Actions Runner Controller is a Kubernetes controller that manages self-hosted GitHub Actions as Kubernetes pods. It allows you to dynamically scale and orchestrate runners based on your workflows, providing better resource utilization and integration with Kubernetes environments. See <a href="/en/actions/hosting-your-own-runners/managing-self-hosted-runners-with-actions-runner-controller/about-actions-runner-controller">About Actions Runner Controller</a>.</p>
<h2><a href="#dependabot-on-arc">Dependabot on ARC</a></h2>
<p>You can run Dependabot on self-hosted GitHub Actions runners managed within a Kubernetes cluster via ARC. This enables auto-scaling, workload isolation, and better resource management for Dependabot jobs, ensuring that dependency updates can run efficiently within an organization's controlled infrastructure while integrating seamlessly with GitHub Actions.</p>
<h2><a href="#setting-up-arc-for-dependabot-on-your-local-environment">Setting up ARC for Dependabot on your Local environment</a></h2>
<h3><a href="#prerequisites">Prerequisites</a></h3>
<ul>
<li>A Kubernetes cluster
<ul>
<li>For a managed cloud environment, you can use Azure Kubernetes Service (AKS).</li>
<li>For a local setup, you can use minikube.</li>
</ul>
</li>
<li>Helm
<ul>
<li>A package manager for Kubernetes.</li>
</ul>
</li>
</ul>
<h3><a href="#setting-up-arc">Setting up ARC</a></h3>
<ol>
<li>
<p>Install ARC. For more information, see <a href="/en/actions/hosting-your-own-runners/managing-self-hosted-runners-with-actions-runner-controller/quickstart-for-actions-runner-controller">Quickstart for Actions Runner Controller</a>.</p>
</li>
<li>
<p>Create a work directory for the ARC setup and create a shell script file (for example, <code>helm_install_arc.sh</code>) to install the latest ARC version.</p>
<div>
<header><span>Bash</span><pre>    mkdir ARC
    touch helm_install_arc.sh
    chmod 755 helm_install_arc.sh
</pre></header><pre><code>    <span>mkdir</span> ARC
    <span>touch</span> helm_install_arc.sh
    <span>chmod</span> 755 helm_install_arc.sh
</code></pre>
</div>
</li>
<li>
<p>Edit <code>helm_install_arc.sh</code> with this bash script for installing ARC.</p>
<div>
<header><span>Text</span><pre>NAMESPACE="arc-systems"
helm install arc \
    --namespace "${NAMESPACE}" \
    --create-namespace \
    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set-controller
</pre></header><pre><code>NAMESPACE="arc-systems"
helm install arc \
    --namespace "${NAMESPACE}" \
    --create-namespace \
    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set-controller
</code></pre>
</div>
</li>
<li>
<p>Execute the <code>helm_install_arc.sh</code> script file.</p>
<pre><code>./helm_install_arc.sh
</code></pre>
</li>
<li>
<p>Now, you need to configure the runner scale set. For this, let's start by creating and editing a file with the following bash script.</p>
<div>
<header><span>Bash</span><pre>touch arc-runner-set.sh
chmod 755 arc-runner-set.sh
</pre></header><pre><code><span>touch</span> arc-runner-set.sh
<span>chmod</span> 755 arc-runner-set.sh
</code></pre>
</div>
<div>
<header><span>Text</span><pre>INSTALLATION_NAME="dependabot"
NAMESPACE="arc-runners"
GITHUB_CONFIG_URL=REPO_URL
GITHUB_PAT=PAT
helm install "${INSTALLATION_NAME}" \
    --namespace "${NAMESPACE}" \
    --create-namespace \
    --set githubConfigUrl="${GITHUB_CONFIG_URL}" \
    --set githubConfigSecret.github_token="${GITHUB_PAT}" \
    --set containerMode.type="dind" \
    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set
</pre></header><pre><code>INSTALLATION_NAME="dependabot"
NAMESPACE="arc-runners"
GITHUB_CONFIG_URL=REPO_URL
GITHUB_PAT=PAT
helm install "${INSTALLATION_NAME}" \
    --namespace "${NAMESPACE}" \
    --create-namespace \
    --set githubConfigUrl="${GITHUB_CONFIG_URL}" \
    --set githubConfigSecret.github_token="${GITHUB_PAT}" \
    --set containerMode.type="dind" \
    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set
</code></pre>
</div>
</li>
<li>
<p>Execute the <code>arc-runner-set.sh</code> script file.</p>
<div>
<header><span>Bash</span><pre>./arc-runner-set.sh
</pre></header><pre><code>./arc-runner-set.sh
</code></pre>
</div>
</li>
</ol>
<div>
<ul>
<li>The installation name of the runner scale set has to be <code>dependabot</code> in order to target the dependabot job to the runner.</li>
<li>The <code>containerMode.type="dind"</code> configuration is required to allow the runner to connect to the Docker daemon.</li>
<li>If an organization-level or enterprise-level runner is created, then the appropriate scopes should be provided to the Personal Access Token (PAT).</li>
<li>A personal access token (classic) (PAT) can be created. The token should have the following scopes based on whether you are creating a repository, organization or enterprise level runner scale set.
<ul>
<li>Repository level: <strong>repo</strong>
</li>
<li>Organization level: <strong>admin:org</strong>
</li>
<li>Enterprise level: <strong>admin:enterprise</strong><br>
For information about creating a personal access token (classic), see <a href="/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic">Managing your personal access tokens</a>.</li>
</ul>
</li>
</ul>
</div>
<h3><a href="#adding-runner-groups">Adding runner groups</a></h3>
<p>Runner groups are used to control which organizations or repositories have access to runner scale sets. To add a runner scale set to a runner group, you must already have a runner group created.</p>
<p>For information about creating runner groups, see <a href="/en/actions/hosting-your-own-runners/managing-self-hosted-runners/managing-access-to-self-hosted-runners-using-groups#creating-a-self-hosted-runner-group-for-an-organization">Managing access to self-hosted runners using groups</a>.</p>
<p>Don't forget to add the following setting to the runner scale set configuration in the helm chart.</p>
<div>
<header><span>Text</span><pre>--set runnerGroup="&lt;Runner group name&gt;" \
</pre></header><pre><code>--set runnerGroup="&lt;Runner group name&gt;" \
</code></pre>
</div>
<h3><a href="#checking-your-installation">Checking your installation</a></h3>
<ol>
<li>
<p>Check your installation.</p>
<div>
<header><span>Bash</span><pre>helm list -A
</pre></header><pre><code>helm list -A
</code></pre>
</div>
<p>Output:</p>
<pre><code>➜  ARC git:(master) ✗ helm list -A
    NAME           NAMESPACE   REVISION UPDATED                              STATUS   CHART                                  APP VERSION
    arc            arc-systems 1        2025-04-11 14:41:53.70893 -0500 CDT  deployed gha-runner-scale-set-controller-0.11.0 0.11.0
    arc-runner-set arc-runners 1        2025-04-11 15:08:12.58119 -0500 CDT  deployed gha-runner-scale-set-0.11.0            0.11.0
    dependabot     arc-runners 1        2025-04-16 21:53:40.080772 -0500 CDT deployed gha-runner-scale-set-0.11.0
</code></pre>
</li>
<li>
<p>Check the manager pod using this command.</p>
<div>
<header><span>Bash</span><pre>kubectl get pods -n arc-systems
</pre></header><pre><code>kubectl get pods -n arc-systems
</code></pre>
</div>
<p>Output:</p>
<pre><code>➜  ARC git:(master) ✗ kubectl get pods -n arc-systems

NAME                                    READY   STATUS    RESTARTS      AGE
arc-gha-rs-controller-57c67d4c7-zjmw2   1/1     Running   8 (36h ago)   6d9h
arc-runner-set-754b578d-listener        1/1     Running   0             11h
dependabot-754b578d-listener            1/1     Running   0             14h
</code></pre>
</li>
</ol>
<h3><a href="#setting-up-dependabot">Setting up Dependabot</a></h3>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-28260/images/help/repository/repo-actions-settings.png" alt='Screenshot of a repository header showing the tabs. The "Settings" tab is highlighted by a dark orange outline.' width="720" height="71"></source></picture></div>
</li>
<li>
<p>In the "Security" section of the sidebar, click </p>
</li>
<li>
<p>Under "Dependabot", scroll to "Dependabot on Action Runners", and select <strong>Enable</strong> for "Dependabot on self-hosted runners".</p>
</li>
</ol>
<h2><a href="#triggering-a-dependabot-run">Triggering a Dependabot run</a></h2>
<p>Now that you've set up ARC, you can start a Dependabot run.</p>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click the </p>
</li>
<li>
<p>In the left sidebar, click <strong>Dependency graph</strong>.
</p>
<div><picture><source><img src="/assets/cb-3959/images/help/graphs/graphs-sidebar-dependency-graph.png" alt='Screenshot of the "Dependency graph" tab. The tab is highlighted with an orange outline.' width="193" height="246"></source></picture></div>
</li>
<li>
<p>Under "Dependency graph", click <strong>Dependabot</strong>.</p>
</li>
<li>
<p>To the right of the name of manifest file you're interested in, click <strong>Recent update jobs</strong>.</p>
</li>
<li>
<p>If there are no recent update jobs for the manifest file, click <strong>Check for updates</strong> to re-run a Dependabot version updates'job and check for new updates to dependencies for that ecosystem.</p>
</li>
</ol>
<h2><a href="#viewing-the-generated-arc-runners">Viewing the generated ARC runners</a></h2>
<p>You can view the ARC runners that have been created for the Dependabot job.</p>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click </p>
<div><picture><source><img src="/assets/cb-12958/images/help/repository/actions-tab-global-nav-update.png" alt='Screenshot of the tabs for the "github/docs" repository. The "Actions" tab is highlighted with an orange outline.' width="1242" height="186"></source></picture></div>
</li>
<li>
<p>On the left sidebar, click <strong>Runners</strong>.</p>
</li>
<li>
<p>Under "Runners", click <strong>Self-hosted runners</strong> to view the list of all the runners available in the repository. You can see the ephemeral dependabot runner that has been created.
</p>
<div><picture><source><img src="/assets/cb-71012/images/help/dependabot/dependabot-self-hosted-runner.png" alt="Screenshot showing a dependabot runner in the list of available runners. The runner is highlighted with an orange outline."></source></picture></div>
<p>You can also view the same dependabot runner pod created in your kubernetes cluster from the terminal by executing this command.</p>
<div>
<header><span>Text</span><pre>➜  ARC git:(master) ✗ kubectl get pods -n arc-runners
    NAME                            READY   STATUS    RESTARTS   AGE
    dependabot-sw8zn-runner-4mbc7   2/2     Running   0          46s
</pre></header><pre><code>➜  ARC git:(master) ✗ kubectl get pods -n arc-runners
    NAME                            READY   STATUS    RESTARTS   AGE
    dependabot-sw8zn-runner-4mbc7   2/2     Running   0          46s
</code></pre>
</div>
</li>
</ol>
<p>Additionally, you can verify:</p>
<ul>
<li>
<p>The logs, by checking the runner and machine name. See <a href="/en/code-security/dependabot/troubleshooting-dependabot/viewing-dependabot-job-logs">Viewing Dependabot job logs</a>.</p>
<p><picture><source><img src="/assets/cb-1020027/images/help/dependabot/dependabot-self-hosted-runner-log.png" alt="Example of log for a dependabot self hosted runner."></source></picture></p>
</li>
<li>
<p>The version update pull requests created by the dependabot job in the <strong>Pull requests</strong> tab of the repository.</p>
</li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>