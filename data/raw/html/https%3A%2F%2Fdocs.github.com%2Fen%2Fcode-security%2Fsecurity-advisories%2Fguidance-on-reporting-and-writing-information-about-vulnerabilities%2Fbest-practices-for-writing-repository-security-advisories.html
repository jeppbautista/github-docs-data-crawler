<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Security advisories" href="/en/code-security/security-advisories">Security advisories</a><span>/</span>
</li>
<li>
<a title="Guidance on reporting and writing" href="/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities">Guidance on reporting and writing</a><span>/</span>
</li>
<li><a title="Best practices" href="/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/best-practices-for-writing-repository-security-advisories">Best practices</a></li>
</ul></nav></div>
<div>
<div><div><h1>Best practices for writing repository security advisories</h1></div></div>
<div>
<div><p>When you create or edit security advisories, the information you provide is easier for other users to understand when you specify the ecosystem, package name, and affected versions using the standard formats.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div><p>Repository owners, organization owners, security managers, and users with the <strong>admin</strong> role</p></div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-security-advisories-for-repositories"><div><span>About security advisories for repositories</span></div></a></li>
<li><a href="#ecosystem"><div><span>Ecosystem</span></div></a></li>
<li><a href="#package-name"><div><span>Package name</span></div></a></li>
<li><a href="#affected-versions"><div><span>Affected versions</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<div>
<p>
If you are a security researcher, you should directly contact maintainers to ask them to create security advisories or issue CVEs on your behalf in repositories that you don't administer. However, if private vulnerability reporting is enabled for the repository, you can <em>privately</em> report a vulnerability yourself. For more information, see <a href="/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability">Privately reporting a security vulnerability</a>.</p>
</div>
<h2><a href="#about-security-advisories-for-repositories">About security advisories for repositories</a></h2>
<p>Repository security advisories allow maintainers of public repositories to privately discuss and fix a security vulnerability in a project. After collaborating on a fix, repository maintainers can publish the security advisory to publicly disclose the security vulnerability to the project's community. By publishing security advisories, repository maintainers make it easier for their community to update package dependencies and research the impact of the security vulnerabilities. For more information, see <a href="/en/code-security/security-advisories/working-with-repository-security-advisories/about-repository-security-advisories">About repository security advisories</a>.</p>
<p>We recommend you use the syntax used in the GitHub Advisory Database, especially the version formatting, when you write a repository security advisory, or make a community contribution to a global security advisory.</p>
<p>If you follow the syntax for the GitHub Advisory Database, especially when you define affected versions:</p>
<ul>
<li>When you publish your repository advisory, we can add your advisory to the GitHub Advisory Database as a "GitHub-reviewed" advisory, without needing to ask for more information.</li>
<li>Dependabot will have the information to accurately identify repositories that are affected and send them Dependabot alerts to notify them.</li>
<li>Community members are less likely to suggest edits to your advisory to fix missing or incorrect information.</li>
</ul>
<p>You add or edit a repository advisory using the <em>Draft security advisory</em> form. For more information, see <a href="/en/code-security/security-advisories/working-with-repository-security-advisories/creating-a-repository-security-advisory">Creating a repository security advisory</a>.</p>
<p>You suggest an improvement to an existing global advisory using the <em>Improve security advisory</em> form. For more information, see <a href="/en/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/editing-security-advisories-in-the-github-advisory-database">Editing security advisories in the GitHub Advisory Database</a>.</p>
<h2><a href="#ecosystem">Ecosystem</a></h2>
<p>You need to assign the advisory to one of our supported ecosystems using the <strong>Ecosystem</strong> field. For more information about the ecosystems we support, see <a href="/en/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/browsing-security-advisories-in-the-github-advisory-database#github-reviewed-advisories">Browsing security advisories in the GitHub Advisory Database</a>.</p>
<p><picture><source><img src="/assets/cb-28743/images/help/security/security-advisory-ecosystem.png" alt='Screenshot of the "Affected products" area of the security advisory form. The "Ecosystem" field is highlighted with a dark orange outline.' width="710" height="236"></source></picture></p>
<h2><a href="#package-name">Package name</a></h2>
<p>We recommend that you use the <strong>Package name</strong> field to specify which packages are affected because package information is required for "GitHub-reviewed" advisories in the GitHub Advisory Database. Package information is optional for repository-level security advisories, but including this information early simplifies the review process when you publish your security advisory.</p>
<h2><a href="#affected-versions">Affected versions</a></h2>
<p>We recommend that you use the <strong>Affected versions</strong> field to specify which versions are affected because this information is required for "GitHub-reviewed" advisories in the GitHub Advisory Database. Version information is optional for repository-level security advisories, but including this information early simplifies the review process when you publish your security advisory.</p>
<p>For more information about the GitHub Advisory Database, see <a href="https://github.com/github/advisory-database">https://github.com/github/advisory-database</a>.</p>
<h3><a href="#glossary">Glossary</a></h3>
<ul>
<li>
<strong>Vulnerable Version Range (VVR):</strong> the range of versions that are vulnerable to a particular software bug.</li>
<li>
<strong>Operator:</strong> any symbol that indicates the boundary of a vulnerable version range.</li>
<li>
<strong>Open Source Vulnerability format (OSV):</strong> format that the GitHub Advisory Database data strives to be compatible with.</li>
</ul>
<h3><a href="#version-syntax">Version syntax</a></h3>
<ul>
<li>Smaller numbers are earlier versions than larger numbers. for example, <code>1.0.0</code> is a lower version than <code>2.0.0</code>
</li>
<li>Earlier letters in the alphabet are earlier versions than later letters in the alphabet. For example, <code>2.0.0-a</code> is an earlier version than <code>2.0.0-b</code>.</li>
<li>Any letters that come after a number are considered part of a prerelease, so any versions with letters after the numbers are earlier versions than numbers without letters in the version number. For example, <code>2.0.0-alpha</code>, <code>2.0.0-beta</code>, and <code>2.0.0-rc</code> are earlier than <code>2.0.0</code>.</li>
<li>A fixed version cannot be smaller than the largest number in the VVR. For example, a vulnerable version is released and the maintainer recommends downgrading. The maintainer cannot label that lower version as a fixed or patched version in the <code>Fixed</code> field because that version is smaller than the vulnerable version.</li>
</ul>
<h3><a href="#supported-operators">Supported operators</a></h3>
<ul>
<li>
<p><code>&gt;=</code> for “greater than or equal to this version”.</p>
</li>
<li>
<p><code>&gt;</code> for “greater than this version”.</p>
<div>
<p> Although GitHub supports the use of the <code>&gt;</code> operator, using this operator is not recommended because it's not supported by the OSV format.</p>
</div>
</li>
<li>
<p><code>=</code> for “equal to this version”.</p>
</li>
<li>
<p><code>&lt;=</code> for “less than or equal to this version”.</p>
</li>
<li>
<p><code>&lt;</code> for “less than this version”.</p>
</li>
</ul>
<h3><a href="#specifying-affected-versions-on-github">Specifying affected versions on GitHub</a></h3>
<p>It is important to clearly define the affected versions for an advisory. GitHub provides several options in the <strong>Affected versions</strong> field for you to specify vulnerable version ranges.</p>
<p>For examples showing how affected versions are defined in some existing advisories, see <a href="#examples">Examples</a>.</p>
<ul>
<li>
<p>A valid affected version string consists of one of the following:</p>
<ul>
<li>
<p>A lower bound operator sequence.</p>
</li>
<li>
<p>An upper bound operator sequence.</p>
</li>
<li>
<p>Both an upper and lower bound operator sequence. The lower bound must come first, followed by a comma and a single space, then the upper bound.</p>
</li>
<li>
<p>A specific version sequence using the equality (<code>=</code>) operator.</p>
</li>
<li>
<p>Each operator sequence must be specified as the operator, a single space, and then the version. For more information about valid operators, see <a href="#supported-operators">Supported operators</a> above.</p>
</li>
<li>
<p>The version must begin with a number followed by any number of numbers, letters, dots, dashes, or underscores (anything other than a space or comma). For more information about version formatting, see <a href="#version-syntax">Version syntax</a> above.</p>
</li>
</ul>
<div>
<p>
Affected version strings cannot contain leading or trailing spaces.</p>
</div>
</li>
<li>
<p>Upper-bound operators can be inclusive or exclusive, i.e. <code>&lt;=</code> or <code>&lt;</code>, respectively.</p>
</li>
<li>
<p>Lower-bound operators can be inclusive or exclusive, i.e. <code>&gt;=</code> or <code>&gt;</code>, respectively. However, if you publish your repository advisory, and we graduate your repository advisory into a global advisory, a different rule applies: lower-bound strings can only be inclusive, i.e. <code>&gt;=</code>. The exclusive lower bound operator (<code>&gt;</code>) is only allowed when the version is <code>0</code>, for example <code>&gt; 0</code>.</p>
</li>
<li>
<p>Proper use of spaces</p>
<ul>
<li>
<p>Use a space between an operator and a version number.</p>
</li>
<li>
<p>Do not use a space in <code>&gt;=</code> or <code>&lt;=</code>.</p>
</li>
<li>
<p>Do not use a space between a number and a comma in <code>&gt;= lower bound, &lt;= upper bound</code>.</p>
</li>
<li>
<p>Use a space between a comma and the upper bound operator.</p>
</li>
</ul>
<div>
<p>
The lower-bound limitation:</p>
<ul>
<li>Is due to incompatibilities with the OSV schema.</li>
<li>Only applies when you make a suggestion on an existing advisory in the GitHub Advisory Database.</li>
</ul>
</div>
</li>
<li>
<p>You cannot specify multiple affected version ranges in the same field, such as <code>&gt; 2.0, &lt; 2.3, &gt; 3.0, &lt; 3.2</code>.To specify more than one range, you must create a new <strong>Affected products</strong> section for each range, by clicking the <strong>+ Add another affected product</strong> button.</p>
<p><picture><source><img src="/assets/cb-44764/images/help/security/security-advisory-add-another-affected-product.png" alt='Screenshot of the "Affected products" area of the security advisory form. The "Add another affected product" link is outlined in dark orange.' width="709" height="366"></source></picture></p>
</li>
<li>
<p>If the affected version range includes only a single upper or lower bound:</p>
<ul>
<li>The implicit value is always <code>&gt; 0</code> if the lower bound is not explicitly specified.</li>
<li>The implicit value is always infinity if the upper bound is not explicitly specified.</li>
</ul>
</li>
</ul>
<h3><a href="#setting-an-upper-bound-only-on-a-vvr">Setting an upper bound only on a VVR</a></h3>
<ul>
<li>If you set only an upper bound, use <code>&lt;=</code> or <code>&lt;</code>.</li>
<li>The GitHub Advisory Database uses the PyPA database as one of its data sources. However, GitHub doesn't match the PyPA VVR format exactly (PyPa security advisories often use <code>&gt;= 0, &lt;= n</code> or <code>&gt;= 0, &lt; n</code> to refer to version ranges that only have an upper bound).</li>
<li>There is no need to include <code>&gt;= 0</code> in a range that only has an upper bound.</li>
</ul>
<h3><a href="#setting-a-lower-bound-only-on-a-vvr">Setting a lower bound only on a VVR</a></h3>
<ul>
<li>The advisory curation team doesn't recommend setting lower bounds only on any advisory other than malware.
This is because, if a fixed version is ever released, users of the fixed version will continue to receive unnecessary Dependabot alerts until the advisory is manually updated.</li>
<li>Use <code>&gt;= 0</code> for all versions</li>
<li>
<code>&gt; 0</code> is generally not used.</li>
</ul>
<h3><a href="#specifying-only-one-affected-version">Specifying only one affected version</a></h3>
<ul>
<li>
<code>= n</code> for the single affected version</li>
<li>Keep in mind that the <code>=</code> will not automatically include any public or private previews, <em>only</em> the version specified.</li>
</ul>
<h3><a href="#common-errors">Common errors</a></h3>
<ul>
<li>
<p>Avoid using the <code>&lt; n</code> vulnerable version range and then saying <code>n+1</code> is patched.</p>
<ul>
<li>
<code>&lt; n</code> should only be used when <code>n</code> is not vulnerable.</li>
<li>In this case, the VVR should be <code>&lt;= n</code> or <code>&lt; n+1</code>.</li>
</ul>
</li>
<li>
<p>Avoid using only a number when describing fixed versions with official version numbers that have letters. Say your software has two branches, <code>linux</code> and <code>windows</code>. When you release <code>2.0.0-linux</code> and <code>2.0.0-windows</code>, using <code>&lt; 2.0.0</code> as the vulnerable version will mark <code>2.0.0-linux</code> and <code>2.0.0-windows</code> as vulnerable because the version logic interprets <code>-linux</code> and <code>-windows</code> as prereleases. You will need to mark <code>2.0.0-linux</code>, the earliest branch in the alphabet, as the first patched version to avoid <code>2.0.0-linux</code> and <code>2.0.0-windows</code> being considered vulnerable.</p>
</li>
</ul>
<h3><a href="#examples">Examples</a></h3>
<h4><a href="#advisory-with-multiple-vvrs-and-multiple-operators">Advisory with multiple VVRs and multiple operators</a></h4>
<p><a href="https://github.com/advisories/GHSA-wr2v-9rpq-c35q">Etcd Gateway TLS authentication only applies to endpoints detected in DNS SRV records (GHSA-wr2v-9rpq-c35q)</a> has two vulnerable version ranges:</p>
<ul>
<li>
<code>&lt; 3.3.23</code>, which has an upper bound with no lower bound and uses the <code>&lt;</code> operator.</li>
<li>
<code>&gt;= 3.4.0-rc.0, &lt;= 3.4.9</code>, which has both an upper bound and a lower bound, and uses the <code>&gt;=</code> and <code>&lt;=</code> operators.</li>
</ul>
<h4><a href="#advisory-showing-the-relationship-between-a-prerelease-and-a-regular-release">Advisory showing the relationship between a prerelease and a regular release</a></h4>
<p><a href="https://github.com/advisories/GHSA-wcg9-pgqv-xm5v">XWiki Platform allows XSS through XClass name in string properties (GHSA-wcg9-pgqv-xm5v)</a> has four vulnerable version ranges:</p>
<ul>
<li><code>&gt;= 1.1.2, &lt; 14.10.21</code></li>
<li><code>&gt;= 15.0-rc-1, &lt; 15.5.5</code></li>
<li><code>&gt;= 15.6-rc-1, &lt; 15.10.6</code></li>
<li><code>= 16.0.0-rc-1</code></li>
</ul>
<p>Three of these VVRs include prereleases in the range of vulnerable versions. The last VVR, <code>= 16.0.0-rc-1</code>, shows that only <code>16.0.0-rc-1</code> is vulnerable, while the regular release that came after it, <code>16.0.0</code>, isn't. The logic considers <code>16.0.0-rc-1</code> and <code>16.0.0</code> as separate versions, with <code>16.0.0-rc-1</code> being an earlier release than <code>16.0.0</code>.</p>
<p>The patch for this vulnerability was published on Jan 24, 2024, for version 16.0.0. For more information see <a href="https://github.com/xwiki/xwiki-platform/commit/27eca8423fc1ad177518077a733076821268509c">commit 27eca84</a> in the <code>xwiki/xwiki-platform </code> repository. The <a href="https://mvnrepository.com/artifact/org.xwiki.platform/xwiki-platform-oldcore">XWiki Platform Old Core</a> page in the MVN Repository site shows that <code>16.0.0-rc-1</code> was published on Jan 22, 2024, before the fix was added to XWiki, and <code>16.0.0</code> was published on Jan 29, 2024, after the fix was committed.</p>
<h4><a href="#advisory-with-branch-names-in-version-numbers">Advisory with branch names in version numbers</a></h4>
<p><a href="https://mvnrepository.com/artifact/com.google.guava/guava">Google Guava</a> has two branches, <code>android</code> and <code>jre</code>, in its version releases. <a href="https://github.com/advisories/GHSA-7g45-4rm6-3mm3">Guava vulnerable to insecure use of temporary directory (GHSA-7g45-4rm6-3mm3)</a> and <a href="https://github.com/advisories/GHSA-5mg8-w23w-74h3">Information Disclosure in Guava (GHSA-5mg8-w23w-74h3)</a> are advisories about vulnerabilities that affect Guava. Both advisories set <code>32.0.0-android</code> as the patched version.</p>
<ul>
<li>The version range logic interprets letters after <code>32.0.0</code> as prereleases, so if you set the patched version to <code>32.0.0</code>, then both <code>32.0.0-android</code> and <code>32.0.0-jre</code> would be incorrectly marked as vulnerable.</li>
<li>The version range logic interprets letters later in the alphabet as being a later version than letters earlier in the alphabet, so if you set the patched version to <code>32.0.0-jre</code>, then <code>32.0.0-android</code> would be incorrectly marked as vulnerable.</li>
</ul>
<p>The best way to indicate that both <code>32.0.0-android</code> and <code>32.0.0-jre</code> are patched is to use <code>32.0.0-android</code> as the patched version, and the logic will interpret everything after <code>32.0.0-android</code> in the alphabet as patched.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>