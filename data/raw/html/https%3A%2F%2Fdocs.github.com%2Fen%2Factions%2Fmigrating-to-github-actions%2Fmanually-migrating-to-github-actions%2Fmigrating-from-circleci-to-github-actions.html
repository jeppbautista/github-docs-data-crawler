<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="GitHub Actions" href="/en/actions">GitHub Actions</a><span>/</span>
</li>
<li>
<a title="Migrate to GitHub Actions" href="/en/actions/migrating-to-github-actions">Migrate to GitHub Actions</a><span>/</span>
</li>
<li>
<a title="Manual migrations" href="/en/actions/migrating-to-github-actions/manually-migrating-to-github-actions">Manual migrations</a><span>/</span>
</li>
<li><a title="Migrate from CircleCI" href="/en/actions/migrating-to-github-actions/manually-migrating-to-github-actions/migrating-from-circleci-to-github-actions">Migrate from CircleCI</a></li>
</ul></nav></div>
<div>
<div><div><h1>Migrating from CircleCI to GitHub Actions</h1></div></div>
<div><div><p>GitHub Actions and CircleCI share several similarities in configuration, which makes migration to GitHub Actions relatively straightforward.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#introduction"><div><span>Introduction</span></div></a></li>
<li><a href="#key-differences"><div><span>Key differences</span></div></a></li>
<li><a href="#migrating-workflows-and-jobs"><div><span>Migrating workflows and jobs</span></div></a></li>
<li><a href="#migrating-orbs-to-actions"><div><span>Migrating orbs to actions</span></div></a></li>
<li><a href="#using-docker-images"><div><span>Using Docker images</span></div></a></li>
<li><a href="#using-variables-and-secrets"><div><span>Using variables and secrets</span></div></a></li>
<li><a href="#caching"><div><span>Caching</span></div></a></li>
<li><a href="#persisting-data-between-jobs"><div><span>Persisting data between jobs</span></div></a></li>
<li><a href="#using-databases-and-service-containers"><div><span>Using databases and service containers</span></div></a></li>
<li><a href="#complete-example"><div><span>Complete Example</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#introduction">Introduction</a></h2>
<p>CircleCI and GitHub Actions both allow you to create workflows that automatically build, test, publish, release, and deploy code. CircleCI and GitHub Actions share some similarities in workflow configuration:</p>
<ul>
<li>Workflow configuration files are written in YAML and stored in the repository.</li>
<li>Workflows include one or more jobs.</li>
<li>Jobs include one or more steps or individual commands.</li>
<li>Steps or tasks can be reused and shared with the community.</li>
</ul>
<p>For more information, see <a href="/en/actions/learn-github-actions/understanding-github-actions">Understanding GitHub Actions</a>.</p>
<h2><a href="#key-differences">Key differences</a></h2>
<p>When migrating from CircleCI, consider the following differences:</p>
<ul>
<li>CircleCI’s automatic test parallelism automatically groups tests according to user-specified rules or historical timing information. This functionality is not built into GitHub Actions.</li>
<li>Actions that execute in Docker containers are sensitive to permissions problems since containers have a different mapping of users. You can avoid many of these problems by not using the <code>USER</code> instruction in your <em>Dockerfile</em>. For more information about the Docker filesystem on GitHub-hosted runners, see <a href="/en/actions/using-github-hosted-runners/about-github-hosted-runners#docker-container-filesystem">Using GitHub-hosted runners</a>.</li>
</ul>
<h2><a href="#migrating-workflows-and-jobs">Migrating workflows and jobs</a></h2>
<p>CircleCI defines <code>workflows</code> in the <em>config.yml</em> file, which allows you to configure more than one workflow. GitHub requires one workflow file per workflow, and as a consequence, does not require you to declare <code>workflows</code>. You'll need to create a new workflow file for each workflow configured in <em>config.yml</em>.</p>
<p>Both CircleCI and GitHub Actions configure <code>jobs</code> in the configuration file using similar syntax. If you configure any dependencies between jobs using <code>requires</code> in your CircleCI workflow, you can use the equivalent GitHub Actions <code>needs</code> syntax. For more information, see <a href="/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idneeds">Workflow syntax for GitHub Actions</a>.</p>
<h2><a href="#migrating-orbs-to-actions">Migrating orbs to actions</a></h2>
<p>Both CircleCI and GitHub Actions provide a mechanism to reuse and share tasks in a workflow. CircleCI uses a concept called orbs, written in YAML, to provide tasks that people can reuse in a workflow. GitHub Actions has powerful and flexible reusable components called actions, which you build with either JavaScript files or Docker images. You can create actions by writing custom code that interacts with your repository in any way you'd like, including integrating with GitHub's APIs and any publicly available third-party API. For example, an action can publish npm modules, send SMS alerts when urgent issues are created, or deploy production-ready code. For more information, see <a href="/en/actions/creating-actions">Sharing automations</a>.</p>
<p>CircleCI can reuse pieces of workflows with YAML anchors and aliases. GitHub Actions supports the most common need for reusability using matrices. For more information about matrices, see <a href="/en/actions/using-jobs/using-a-matrix-for-your-jobs">Running variations of jobs in a workflow</a>.</p>
<h2><a href="#using-docker-images">Using Docker images</a></h2>
<p>Both CircleCI and GitHub Actions support running steps inside of a Docker image.</p>
<p>CircleCI provides a set of pre-built images with common dependencies. These images have the <code>USER</code> set to <code>circleci</code>, which causes permissions to conflict with GitHub Actions.</p>
<p>We recommend that you move away from CircleCI's pre-built images when you migrate to GitHub Actions. In many cases, you can use actions to install the additional dependencies you need.</p>
<p>For more information about the Docker filesystem, see <a href="/en/actions/using-github-hosted-runners/about-github-hosted-runners#docker-container-filesystem">Using GitHub-hosted runners</a>.</p>
<p>For more information about the tools and packages available on GitHub-hosted runner images, see <a href="/en/actions/using-github-hosted-runners/about-github-hosted-runners#supported-software">Using GitHub-hosted runners</a>.</p>
<h2><a href="#using-variables-and-secrets">Using variables and secrets</a></h2>
<p>CircleCI and GitHub Actions support setting variables in the configuration file and creating secrets using the CircleCI or GitHub UI.</p>
<p>For more information, see <a href="/en/actions/learn-github-actions/variables#default-environment-variables">Store information in variables</a> and <a href="/en/actions/security-guides/using-secrets-in-github-actions">Using secrets in GitHub Actions</a>.</p>
<h2><a href="#caching">Caching</a></h2>
<p>CircleCI and GitHub Actions provide a method to manually cache files in the configuration file.</p>
<p>Below is an example of the syntax for each system.</p>
<h3><a href="#circleci-syntax-for-caching">CircleCI syntax for caching</a></h3>
<pre><code><span>-</span> <span>restore_cache:</span>
    <span>keys:</span>
      <span>-</span> <span>v1-npm-deps-{{</span> <span>checksum</span> <span>"package-lock.json"</span> <span>}}</span>
      <span>-</span> <span>v1-npm-deps-</span>
</code></pre>
<h3><a href="#github-actions-syntax-for-caching">GitHub Actions syntax for caching</a></h3>
<pre><code><span>-</span> <span>name:</span> <span>Cache</span> <span>node</span> <span>modules</span>
  <span>uses:</span> <span>actions/cache@v4</span>
  <span>with:</span>
    <span>path:</span> <span>~/.npm</span>
    <span>key:</span> <span>v1-npm-deps-${{</span> <span>hashFiles('**/package-lock.json')</span> <span>}}</span>
    <span>restore-keys:</span> <span>v1-npm-deps-</span>
</code></pre>
<p>GitHub Actions does not have an equivalent of CircleCI’s Docker Layer Caching (or DLC).</p>
<h2><a href="#persisting-data-between-jobs">Persisting data between jobs</a></h2>
<p>Both CircleCI and GitHub Actions provide mechanisms to persist data between jobs.</p>
<p>Below is an example in CircleCI and GitHub Actions configuration syntax.</p>
<h3><a href="#circleci-syntax-for-persisting-data-between-jobs">CircleCI syntax for persisting data between jobs</a></h3>
<pre><code><span>-</span> <span>persist_to_workspace:</span>
    <span>root:</span> <span>workspace</span>
    <span>paths:</span>
      <span>-</span> <span>math-homework.txt</span>

<span>...</span>

<span>-</span> <span>attach_workspace:</span>
    <span>at:</span> <span>/tmp/workspace</span>
</code></pre>
<h3><a href="#github-actions-syntax-for-persisting-data-between-jobs">GitHub Actions syntax for persisting data between jobs</a></h3>
<pre><code><span>-</span> <span>name:</span> <span>Upload</span> <span>math</span> <span>result</span> <span>for</span> <span>job</span> <span>1</span>
  <span>uses:</span> <span>actions/upload-artifact@v4</span>
  <span>with:</span>
    <span>name:</span> <span>homework</span>
    <span>path:</span> <span>math-homework.txt</span>

<span>...</span>

<span>-</span> <span>name:</span> <span>Download</span> <span>math</span> <span>result</span> <span>for</span> <span>job</span> <span>1</span>
  <span>uses:</span> <span>actions/download-artifact@v4</span>
  <span>with:</span>
    <span>name:</span> <span>homework</span>
</code></pre>
<p>For more information, see <a href="/en/actions/using-workflows/storing-workflow-data-as-artifacts">Storing and sharing data from a workflow</a>.</p>
<h2><a href="#using-databases-and-service-containers">Using databases and service containers</a></h2>
<p>Both systems enable you to include additional containers for databases, caching, or other dependencies.</p>
<p>In CircleCI, the first image listed in the <em>config.yaml</em> is the primary image used to run commands. GitHub Actions uses explicit sections: use <code>container</code> for the primary container, and list additional containers in <code>services</code>.</p>
<p>Below is an example in CircleCI and GitHub Actions configuration syntax.</p>
<h3><a href="#circleci-syntax-for-using-databases-and-service-containers">CircleCI syntax for using databases and service containers</a></h3>
<pre><code><span>---</span>
<span>version:</span> <span>2.1</span>

<span>jobs:</span>

  <span>ruby-26:</span>
    <span>docker:</span>
      <span>-</span> <span>image:</span> <span>circleci/ruby:2.6.3-node-browsers-legacy</span>
        <span>environment:</span>
          <span>PGHOST:</span> <span>localhost</span>
          <span>PGUSER:</span> <span>administrate</span>
          <span>RAILS_ENV:</span> <span>test</span>
      <span>-</span> <span>image:</span> <span>postgres:10.1-alpine</span>
        <span>environment:</span>
          <span>POSTGRES_USER:</span> <span>administrate</span>
          <span>POSTGRES_DB:</span> <span>ruby26</span>
          <span>POSTGRES_PASSWORD:</span> <span>""</span>

    <span>working_directory:</span> <span>~/administrate</span>

    <span>steps:</span>
      <span>-</span> <span>checkout</span>

      <span># Bundle install dependencies</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>install</span> <span>--path</span> <span>vendor/bundle</span>

      <span># Wait for DB</span>
      <span>-</span> <span>run:</span> <span>dockerize</span> <span>-wait</span> <span>tcp://localhost:5432</span> <span>-timeout</span> <span>1m</span>

      <span># Setup the environment</span>
      <span>-</span> <span>run:</span> <span>cp</span> <span>.sample.env</span> <span>.env</span>

      <span># Setup the database</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span> <span>db:setup</span>

      <span># Run the tests</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span>

<span>workflows:</span>
  <span>version:</span> <span>2</span>
  <span>build:</span>
    <span>jobs:</span>
      <span>-</span> <span>ruby-26</span>
<span>...</span>

<span>-</span> <span>attach_workspace:</span>
    <span>at:</span> <span>/tmp/workspace</span>
</code></pre>
<h3><a href="#github-actions-syntax-for-using-databases-and-service-containers">GitHub Actions syntax for using databases and service containers</a></h3>
<pre><code><span>name:</span> <span>Containers</span>

<span>on:</span> [<span>push</span>]

<span>jobs:</span>
  <span>build:</span>

    <span>runs-on:</span> <span>ubuntu-latest</span>
    <span>container:</span> <span>circleci/ruby:2.6.3-node-browsers-legacy</span>

    <span>env:</span>
      <span>PGHOST:</span> <span>postgres</span>
      <span>PGUSER:</span> <span>administrate</span>
      <span>RAILS_ENV:</span> <span>test</span>

    <span>services:</span>
      <span>postgres:</span>
        <span>image:</span> <span>postgres:10.1-alpine</span>
        <span>env:</span>
          <span>POSTGRES_USER:</span> <span>administrate</span>
          <span>POSTGRES_DB:</span> <span>ruby25</span>
          <span>POSTGRES_PASSWORD:</span> <span>""</span>
        <span>ports:</span>
          <span>-</span> <span>5432</span><span>:5432</span>
        <span># Add a health check</span>
        <span>options:</span> <span>--health-cmd</span> <span>pg_isready</span> <span>--health-interval</span> <span>10s</span> <span>--health-timeout</span> <span>5s</span> <span>--health-retries</span> <span>5</span>

    <span>steps:</span>
      <span># This Docker file changes sets USER to circleci instead of using the default user, so we need to update file permissions for this image to work on GH Actions.</span>
      <span># See https://docs.github.com/actions/using-github-hosted-runners/about-github-hosted-runners#docker-container-filesystem</span>

      <span>-</span> <span>name:</span> <span>Setup</span> <span>file</span> <span>system</span> <span>permissions</span>
        <span>run:</span> <span>sudo</span> <span>chmod</span> <span>-R</span> <span>777</span> <span>$GITHUB_WORKSPACE</span> <span>/github</span> <span>/__w/_temp</span>
      <span>-</span> <span>uses:</span> <span>actions/checkout@v4</span>
      <span>-</span> <span>name:</span> <span>Install</span> <span>dependencies</span>
        <span>run:</span> <span>bundle</span> <span>install</span> <span>--path</span> <span>vendor/bundle</span>
      <span>-</span> <span>name:</span> <span>Setup</span> <span>environment</span> <span>configuration</span>
        <span>run:</span> <span>cp</span> <span>.sample.env</span> <span>.env</span>
      <span>-</span> <span>name:</span> <span>Setup</span> <span>database</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span> <span>db:setup</span>
      <span>-</span> <span>name:</span> <span>Run</span> <span>tests</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span>
</code></pre>
<p>For more information, see <a href="/en/actions/using-containerized-services/about-service-containers">About service containers</a>.</p>
<h2><a href="#complete-example">Complete Example</a></h2>
<p>Below is a real-world example. The left shows the actual CircleCI <em>config.yml</em> for the <a href="https://github.com/thoughtbot/administrate">thoughtbot/administrator</a> repository. The right shows the GitHub Actions equivalent.</p>
<h3><a href="#complete-example-for-circleci">Complete example for CircleCI</a></h3>
<pre><code><span>---</span>
<span>version:</span> <span>2.1</span>

<span>commands:</span>
  <span>shared_steps:</span>
    <span>steps:</span>
      <span>-</span> <span>checkout</span>

      <span># Restore Cached Dependencies</span>
      <span>-</span> <span>restore_cache:</span>
          <span>name:</span> <span>Restore</span> <span>bundle</span> <span>cache</span>
          <span>key:</span> <span>administrate-{{</span> <span>checksum</span> <span>"Gemfile.lock"</span> <span>}}</span>

      <span># Bundle install dependencies</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>install</span> <span>--path</span> <span>vendor/bundle</span>

      <span># Cache Dependencies</span>
      <span>-</span> <span>save_cache:</span>
          <span>name:</span> <span>Store</span> <span>bundle</span> <span>cache</span>
          <span>key:</span> <span>administrate-{{</span> <span>checksum</span> <span>"Gemfile.lock"</span> <span>}}</span>
          <span>paths:</span>
            <span>-</span> <span>vendor/bundle</span>

      <span># Wait for DB</span>
      <span>-</span> <span>run:</span> <span>dockerize</span> <span>-wait</span> <span>tcp://localhost:5432</span> <span>-timeout</span> <span>1m</span>

      <span># Setup the environment</span>
      <span>-</span> <span>run:</span> <span>cp</span> <span>.sample.env</span> <span>.env</span>

      <span># Setup the database</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span> <span>db:setup</span>

      <span># Run the tests</span>
      <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span>

<span>default_job:</span> <span>&amp;default_job</span>
  <span>working_directory:</span> <span>~/administrate</span>
  <span>steps:</span>
    <span>-</span> <span>shared_steps</span>
    <span># Run the tests against multiple versions of Rails</span>
    <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>appraisal</span> <span>install</span>
    <span>-</span> <span>run:</span> <span>bundle</span> <span>exec</span> <span>appraisal</span> <span>rake</span>

<span>jobs:</span>
  <span>ruby-25:</span>
    <span>&lt;&lt;:</span> <span>*default_job</span>
    <span>docker:</span>
      <span>-</span> <span>image:</span> <span>circleci/ruby:2.5.0-node-browsers</span>
        <span>environment:</span>
          <span>PGHOST:</span> <span>localhost</span>
          <span>PGUSER:</span> <span>administrate</span>
          <span>RAILS_ENV:</span> <span>test</span>
      <span>-</span> <span>image:</span> <span>postgres:10.1-alpine</span>
        <span>environment:</span>
          <span>POSTGRES_USER:</span> <span>administrate</span>
          <span>POSTGRES_DB:</span> <span>ruby25</span>
          <span>POSTGRES_PASSWORD:</span> <span>""</span>

  <span>ruby-26:</span>
    <span>&lt;&lt;:</span> <span>*default_job</span>
    <span>docker:</span>
      <span>-</span> <span>image:</span> <span>circleci/ruby:2.6.3-node-browsers-legacy</span>
        <span>environment:</span>
          <span>PGHOST:</span> <span>localhost</span>
          <span>PGUSER:</span> <span>administrate</span>
          <span>RAILS_ENV:</span> <span>test</span>
      <span>-</span> <span>image:</span> <span>postgres:10.1-alpine</span>
        <span>environment:</span>
          <span>POSTGRES_USER:</span> <span>administrate</span>
          <span>POSTGRES_DB:</span> <span>ruby26</span>
          <span>POSTGRES_PASSWORD:</span> <span>""</span>

<span>workflows:</span>
  <span>version:</span> <span>2</span>
  <span>multiple-rubies:</span>
    <span>jobs:</span>
      <span>-</span> <span>ruby-26</span>
      <span>-</span> <span>ruby-25</span>
</code></pre>
<h3><a href="#complete-example-for-github-actions">Complete example for GitHub Actions</a></h3>
<pre><code><span># This workflow uses actions that are not certified by GitHub.</span>
<span># They are provided by a third-party and are governed by</span>
<span># separate terms of service, privacy policy, and support</span>
<span># documentation.</span>

<span># GitHub recommends pinning actions to a commit SHA.</span>
<span># To get a newer version, you will need to update the SHA.</span>
<span># You can also reference a tag or branch, but the action may change without warning.</span>

<span>name:</span> <span>Containers</span>

<span>on:</span> [<span>push</span>]

<span>jobs:</span>
  <span>build:</span>

    <span>strategy:</span>
      <span>matrix:</span>
        <span>ruby:</span> [<span>'2.5'</span>, <span>'2.6.3'</span>]

    <span>runs-on:</span> <span>ubuntu-latest</span>

    <span>env:</span>
      <span>PGHOST:</span> <span>localhost</span>
      <span>PGUSER:</span> <span>administrate</span>
      <span>RAILS_ENV:</span> <span>test</span>

    <span>services:</span>
      <span>postgres:</span>
        <span>image:</span> <span>postgres:10.1-alpine</span>
        <span>env:</span>
          <span>POSTGRES_USER:</span> <span>administrate</span>
          <span>POSTGRES_DB:</span> <span>ruby25</span>
          <span>POSTGRES_PASSWORD:</span> <span>""</span>
        <span>ports:</span>
          <span>-</span> <span>5432</span><span>:5432</span>
        <span># Add a health check</span>
        <span>options:</span> <span>--health-cmd</span> <span>pg_isready</span> <span>--health-interval</span> <span>10s</span> <span>--health-timeout</span> <span>5s</span> <span>--health-retries</span> <span>5</span>

    <span>steps:</span>
      <span>-</span> <span>uses:</span> <span>actions/checkout@v4</span>
      <span>-</span> <span>name:</span> <span>Setup</span> <span>Ruby</span>
        <span>uses:</span> <span>eregon/use-ruby-action@ec02537da5712d66d4d50a0f33b7eb52773b5ed1</span>
        <span>with:</span>
          <span>ruby-version:</span> <span>${{</span> <span>matrix.ruby</span> <span>}}</span>
      <span>-</span> <span>name:</span> <span>Cache</span> <span>dependencies</span>
        <span>uses:</span> <span>actions/cache@v4</span>
        <span>with:</span>
          <span>path:</span> <span>vendor/bundle</span>
          <span>key:</span> <span>administrate-${{</span> <span>matrix.image</span> <span>}}-${{</span> <span>hashFiles('Gemfile.lock')</span> <span>}}</span>
      <span>-</span> <span>name:</span> <span>Install</span> <span>postgres</span> <span>headers</span>
        <span>run:</span> <span>|
          sudo apt-get update
          sudo apt-get install libpq-dev
</span>      <span>-</span> <span>name:</span> <span>Install</span> <span>dependencies</span>
        <span>run:</span> <span>bundle</span> <span>install</span> <span>--path</span> <span>vendor/bundle</span>
      <span>-</span> <span>name:</span> <span>Setup</span> <span>environment</span> <span>configuration</span>
        <span>run:</span> <span>cp</span> <span>.sample.env</span> <span>.env</span>
      <span>-</span> <span>name:</span> <span>Setup</span> <span>database</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span> <span>db:setup</span>
      <span>-</span> <span>name:</span> <span>Run</span> <span>tests</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>rake</span>
      <span>-</span> <span>name:</span> <span>Install</span> <span>appraisal</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>appraisal</span> <span>install</span>
      <span>-</span> <span>name:</span> <span>Run</span> <span>appraisal</span>
        <span>run:</span> <span>bundle</span> <span>exec</span> <span>appraisal</span> <span>rake</span>
</code></pre>
</div></div></div>
</div>
</div></main>
</div></body></html>