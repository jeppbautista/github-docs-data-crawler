<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="GitHub Actions" href="/en/actions">GitHub Actions</a><span>/</span>
</li>
<li>
<a title="Share automations" href="/en/actions/sharing-automations">Share automations</a><span>/</span>
</li>
<li>
<a title="Create actions" href="/en/actions/sharing-automations/creating-actions">Create actions</a><span>/</span>
</li>
<li><a title="CLI setup action" href="/en/actions/sharing-automations/creating-actions/developing-a-third-party-cli-action">CLI setup action</a></li>
</ul></nav></div>
<div>
<div><div><h1>Developing a third party CLI action</h1></div></div>
<div><div><p>Learn how to develop an action to set up a CLI on GitHub Actions runners.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#introduction"><div><span>Introduction</span></div></a></li>
<li><a href="#prerequisites"><div><span>Prerequisites</span></div></a></li>
<li><a href="#example"><div><span>Example</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#introduction">Introduction</a></h2>
<p>You can write an action to provide a way for users to access your servers via a configured CLI environment on GitHub Actions runners.</p>
<p>Your action should:</p>
<ul>
<li>Make it simple for users to specify the version of the CLI to install</li>
<li>Support multiple operating systems</li>
<li>Run in an efficient fashion to minimize run-time and associated costs</li>
<li>Work across GitHub-hosted and self-hosted runners</li>
<li>Leverage community tooling when possible</li>
</ul>
<p>This article will demonstrate how to write an action that retrieves a specific version of your CLI, installs it, adds it to the path, and (optionally) caches it. This type of action (an action that sets up a tool) is often named <code>setup-$TOOL</code>.</p>
<h2><a href="#prerequisites">Prerequisites</a></h2>
<p>You should have an understanding of how to write a custom action. For more information, see <a href="/en/actions/creating-actions/about-custom-actions">About custom actions</a>. For a more detailed guide on how to write a custom action, see <a href="/en/actions/creating-actions/creating-a-javascript-action">Creating a JavaScript action</a>.</p>
<h2><a href="#example">Example</a></h2>
<p>The following script demonstrates how you can get a user-specified version as input, download and extract the specific version of your CLI, then add the CLI to the path.</p>
<p>GitHub provides <a href="https://github.com/actions/toolkit"><code>actions/toolkit</code></a>, which is a set of packages that helps you create actions. This example uses the <a href="https://github.com/actions/toolkit/tree/main/packages/core"><code>actions/core</code></a> and <a href="https://github.com/actions/toolkit/tree/main/packages/tool-cache"><code>actions/tool-cache</code></a> packages.</p>
<div>
<header><span>JavaScript</span><pre>const core = require('@actions/core');
const tc = require('@actions/tool-cache');

async function setup() {
  // Get version of tool to be installed
  const version = core.getInput('version');

  // Download the specific version of the tool, e.g. as a tarball
  const pathToTarball = await tc.downloadTool(getDownloadURL());

  // Extract the tarball onto the runner
  const pathToCLI = await tc.extractTar(pathToTarball);

  // Expose the tool by adding it to the PATH
  core.addPath(pathToCLI)
}

module.exports = setup
</pre></header><pre><code><span>const</span> core = <span>require</span>(<span>'@actions/core'</span>);
<span>const</span> tc = <span>require</span>(<span>'@actions/tool-cache'</span>);

<span>async</span> <span>function</span> <span>setup</span>(<span>// Get version of tool to be installed</span>
  <span>const</span> version = core.<span>getInput</span>(<span>'version'</span>);

  <span>// Download the specific version of the tool, e.g. as a tarball</span>
  <span>const</span> pathToTarball = <span>await</span> tc.<span>downloadTool</span>(<span>getDownloadURL</span>());

  <span>// Extract the tarball onto the runner</span>
  <span>const</span> pathToCLI = <span>await</span> tc.<span>extractTar</span>(pathToTarball);

  <span>// Expose the tool by adding it to the PATH</span>
  core.<span>addPath</span>(pathToCLI)
}

<span>module</span>.<span>exports</span> = setup
</code></pre>
</div>
<p>To use this script, replace <code>getDownloadURL</code> with a function that downloads your CLI. You will also need to create an actions metadata file (<code>action.yml</code>) that accepts a <code>version</code> input and that runs this script. For full details about how to create an action, see <a href="/en/actions/creating-actions/creating-a-javascript-action">Creating a JavaScript action</a>.</p>
<h2><a href="#further-reading">Further reading</a></h2>
<p>This pattern is employed in several actions. For more examples, see:</p>
<ul>
<li><a href="https://github.com/ruby/setup-ruby"><code>ruby/setup-ruby</code></a></li>
<li><a href="https://github.com/google-github-actions/setup-gcloud"><code>google-github-actions/setup-gcloud</code></a></li>
<li><a href="https://github.com/hashicorp/setup-terraform"><code>hashicorp/setup-terraform</code></a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>