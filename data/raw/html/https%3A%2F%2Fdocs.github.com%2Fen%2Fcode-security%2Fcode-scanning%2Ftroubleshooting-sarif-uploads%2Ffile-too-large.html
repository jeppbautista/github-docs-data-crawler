<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Code scanning" href="/en/code-security/code-scanning">Code scanning</a><span>/</span>
</li>
<li>
<a title="Troubleshooting SARIF uploads" href="/en/code-security/code-scanning/troubleshooting-sarif-uploads">Troubleshooting SARIF uploads</a><span>/</span>
</li>
<li><a title="Results file too large" href="/en/code-security/code-scanning/troubleshooting-sarif-uploads/file-too-large">Results file too large</a></li>
</ul></nav></div>
<div>
<div><div><h1>SARIF results file is too large</h1></div></div>
<div><div><p>You cannot upload a SARIF results file larger than 10 MB to code scanning. Explore ways to generate a smaller file containing the highest impact results.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-this-error"><div><span>About this error</span></div></a></li>
<li><a href="#confirming-the-cause-of-the-error"><div><span>Confirming the cause of the error</span></div></a></li>
<li><a href="#fixing-the-problem"><div><span>Fixing the problem</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-this-error">About this error</a></h2>
<pre><code>SARIF file is too large
SARIF results file is too large
SARIF upload is rejected (bigger than allowed size for zip archive)
SARIF ZIP upload is too large
A fatal error occurred: SARIF file is too large
413: Payload Too Large
</code></pre>
<p>One of these errors is reported if a process attempts to upload a SARIF file that is larger than the maximum size of 10 MB. Code scanning does not accept files above this size. There are several different ways to reduce the number of results generated for upload to code scanning.</p>
<p>You could see this error for SARIF files generated by CodeQL or by third-party analysis tools. For information about the limits on uploads, see code scanning, see <a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning#validating-your-sarif-file">SARIF support for code scanning</a>.</p>
<h2><a href="#confirming-the-cause-of-the-error">Confirming the cause of the error</a></h2>
<p>There are many potential causes of very large SARIF results files.</p>
<h3><a href="#sarif-file-compression">SARIF file compression</a></h3>
<p>Take a look at the results file that was rejected by code scanning to see if:</p>
<ul>
<li>The SARIF file was compressed using gzip</li>
<li>The compressed file is smaller than 10 MB</li>
</ul>
<p>If the file wasn't compressed using gzip, try compressing the file before rerunning the upload process. If the compressed file is still too large, you need to configure the analysis to generate a smaller set of results.</p>
<h3><a href="#amount-of-code-analyzed">Amount of code analyzed</a></h3>
<p>If you have too many results, you should configure analysis to analyze only the most important code.</p>
<ul>
<li>For interpreted languages, check if the repository contains many tests, demos, or vendored dependencies where fixing alerts is a lower priority. Try excluding this code from analysis. For more information, see <a href="#excluding-code-from-analysis-for-interpreted-languages">Excluding code from analysis for interpreted languages</a>.</li>
<li>For compiled languages, check if the build process generates more than one variant of the code (for example, targets for multiple operating environments or architectures). Try analyzing just one variant of the code initially. For more information, see <a href="#optimizing-the-build-command">Optimizing the build command</a>.</li>
</ul>
<h3><a href="#number-of-queries-run">Number of queries run</a></h3>
<p>If you still have too many results, check how many queries you are using to analyze the code. Try running fewer queries. You can reintroduce additional queries when the initial alerts are fixed. For example, for CodeQL analysis you could run just the default suite of queries. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#using-queries-in-ql-packs">Customizing your advanced setup for code scanning</a>.</p>
<h3><a href="#number-of-results-found-by-queries">Number of results found by queries</a></h3>
<p>Sometimes a single query reports many results because the codebase has a specific coding style, or because the analysis does not understand a particular library. You can review the results file in a SARIF viewer to see the distribution of results. For example, <a href="https://microsoft.github.io/sarif-web-component/">https://microsoft.github.io/sarif-web-component/</a>.</p>
<ul>
<li>Check if the results are dominated by alerts identified by a single query. Try excluding that query from analysis. You can reintroduce it when other alerts are fixed. For more information about CodeQL query configuration, see <a href="#excluding-a-query-from-analysis">Excluding a query from analysis</a>.</li>
<li>Check if there are dataflow queries with many deep paths. Try omitting dataflow paths from the output. For more information about CodeQL analysis configuration, see <a href="#omitting-dataflow-paths-from-the-output">Omitting dataflow paths from the output</a>.</li>
</ul>
<h2><a href="#fixing-the-problem">Fixing the problem</a></h2>
<p>The following options are listed in order of complexity. You need to revise the configuration to reduce the number of results to a manageable size. Once you have fixed all of those alerts, you can update the configuration to expand the analysis to cover more code or run more queries.</p>
<h3><a href="#excluding-code-from-analysis-for-interpreted-languages">Excluding code from analysis for interpreted languages</a></h3>
<p>Excluding non-production code from analysis is a simple way to reduce the size of the results file.</p>
<ul>
<li>CodeQL advanced setup for code scanning: use <code>paths</code> and <code>paths-ignore</code> in the workflow file to specify what code to analyze. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#specifying-directories-to-scan">Customizing your advanced setup for code scanning</a>.</li>
<li>CodeQL CLI <code>database create</code>: create a YAML configuration file for code scanning using the same syntax to define which code to analyze. Update the <code>database create</code> command to call this configuration file using the <code>--codescanning-config</code> option. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#specifying-directories-to-scan">Customizing your advanced setup for code scanning</a>.</li>
</ul>
<h3><a href="#optimizing-the-build-command">Optimizing the build command</a></h3>
<p>Using a build command that compiles only one variant is a simple way to reduce the size of the results file.</p>
<ul>
<li>CodeQL advanced setup for code scanning: update the workflow file to specify your chosen build command. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/codeql-code-scanning-for-compiled-languages#adding-build-steps-for-a-compiled-language">CodeQL code scanning for compiled languages</a>.</li>
<li>CodeQL CLI <code>database create</code>: specify your chosen build command either by calling the <code>database create</code> command with the <code>--command</code> option, or by defining the build command in a YAML configuration file for code scanning and calling the file using the <code>--codescanning-config</code> option. For more information, see <a href="/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/preparing-your-code-for-codeql-analysis#specifying-build-commands">Preparing your code for CodeQL analysis</a>.</li>
</ul>
<h3><a href="#defining-the-query-suite-to-run">Defining the query suite to run</a></h3>
<p>You may already be running only the default security queries, but it is worth checking.</p>
<ul>
<li>CodeQL advanced setup for code scanning: check the workflow file for the <code>queries</code> keyword. If it is not present, then only the default query suite is run. If it is present, it defines which queries to run. Try commenting out this line of the workflow file. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#using-queries-in-ql-packs">Customizing your advanced setup for code scanning</a>.</li>
<li>CodeQL CLI <code>database analyze</code>: check the database analysis command for any paths that specify queries, query suites, or query packs. If none are present, then only the default query suite is run. If any are present, they define which queries to run, you can try removing them from the call. For more information, see <a href="/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/analyzing-your-code-with-codeql-queries#running-a-codeql-query-pack">Analyzing your code with CodeQL queries</a>.</li>
</ul>
<h3><a href="#excluding-a-query-from-analysis">Excluding a query from analysis</a></h3>
<p>If the results are dominated by the results for a single rule, excluding the rule from the analysis may be the best solution.</p>
<ul>
<li>CodeQL advanced setup for code scanning: use the <code>query-filters</code> keyword to exclude one or more queries from analysis. For more information, see <a href="/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning#excluding-specific-queries-from-analysis">Customizing your advanced setup for code scanning</a>.</li>
<li>CodeQL CLI <code>database analyze</code>: update the database analysis command to exclude one or more queries from analysis. For more information, see <a href="/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/analyzing-your-code-with-codeql-queries#running-a-subset-of-queries-in-a-codeql-pack">Analyzing your code with CodeQL queries</a>.</li>
</ul>
<p>Alternatively, you can use a tool like the <a href="https://github.com/advanced-security/filter-sarif">filter-sarif</a> action to rewrite the SARIF file to exclude specific detections via an exclusion pattern.</p>
<h3><a href="#omitting-dataflow-paths-from-the-output">Omitting dataflow paths from the output</a></h3>
<p>If there are many deep code paths highlighted in the SARIF results, you can reduce the number of paths reported for each alert.</p>
<ul>
<li>
<p>CodeQL advanced setup for code scanning: update the <code>analyze</code> step to limit the number of paths to a maximum of one or zero.</p>
<pre><code><span>-</span> <span>name:</span> <span>Perform</span> <span>CodeQL</span> <span>Analysis</span>
  <span>uses:</span> <span>github/codeql-action/analyze@v3</span>
  <span>env:</span> 
    <span>CODEQL_ACTION_EXTRA_OPTIONS:</span> <span>'{"database":{"interpret-results":["--max-paths", 1]}}'</span>
</code></pre>
</li>
<li>
<p>CodeQL CLI <code>database analyze</code>: update the database analysis command to include the <code>--max-paths=1</code> flag. For more information, see <a href="/en/code-security/codeql-cli/codeql-cli-manual/database-analyze#--max-pathsmaxpaths">database analyze</a>.</p>
</li>
</ul>
<div>
<p>
The <code>max-paths</code> setting affects the results of all dataflow queries.</p>
</div>
<h2><a href="#further-reading">Further reading</a></h2>
<ul>
<li><a href="/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning">SARIF support for code scanning</a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>