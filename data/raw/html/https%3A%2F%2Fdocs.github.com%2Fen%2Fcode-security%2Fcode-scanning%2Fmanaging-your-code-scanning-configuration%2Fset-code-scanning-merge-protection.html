<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="Secure coding" href="/en/code-security">Secure coding</a><span>/</span>
</li>
<li>
<a title="Code scanning" href="/en/code-security/code-scanning">Code scanning</a><span>/</span>
</li>
<li>
<a title="Manage code scanning" href="/en/code-security/code-scanning/managing-your-code-scanning-configuration">Manage code scanning</a><span>/</span>
</li>
<li><a title="Set merge protection" href="/en/code-security/code-scanning/managing-your-code-scanning-configuration/set-code-scanning-merge-protection">Set merge protection</a></li>
</ul></nav></div>
<div>
<div><div><h1>Set code scanning merge protection</h1></div></div>
<div>
<div><p>You can use rulesets to set code scanning merge protection for pull requests.</p></div>
<div><div>
<div><h2>Who can use this feature?</h2></div>
<div><div><p>Organization owners, security managers, and organization members with the <strong>admin</strong> role</p></div></div>
<div><div>
<p>Code scanning is available for the following repository types:</p>
<ul>
<li>Public repositories on GitHub.com</li>
<li>Organization-owned repositories on GitHub Team with <a href="/en/get-started/learning-about-github/about-github-advanced-security">GitHub Code Security</a> enabled</li>
</ul>
</div></div>
</div></div>
</div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-using-rulesets-for-code-scanning-merge-protection"><div><span>About using rulesets for code scanning merge protection</span></div></a></li>
<li><a href="#creating-a-merge-protection-ruleset-for-a-repository"><div><span>Creating a merge protection ruleset for a repository</span></div></a></li>
<li><a href="#creating-a-merge-protection-ruleset-with-the-rest-api"><div><span>Creating a merge protection ruleset with the REST API</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-using-rulesets-for-code-scanning-merge-protection">About using rulesets for code scanning merge protection</a></h2>
<div>
<ul>
<li>Merge protection with rulesets is not related to status checks. For more information about status checks, see <a href="/en/pull-requests/collaborating-with-pull-requests/collaborating-on-repositories-with-code-quality-features/about-status-checks">About status checks</a>.</li>
<li>Merge protection with rulesets will not apply to merge queue groups or Dependabot pull requests analyzed by default setup.</li>
</ul>
</div>
<p>You can use rulesets to prevent pull requests from being merged when one of the following conditions is met:</p>
<ul>
<li>
<p>A required tool found a code scanning alert of a severity that is defined in a ruleset.</p>
</li>
<li>
<p>A required code scanning tool's analysis is still in progress.</p>
</li>
<li>
<p>A required code scanning tool is not configured for the repository.</p>
</li>
</ul>
<p>Typically you should use rulesets target long-lived feature branches, where you would like to guarantee that code has been analyzed before pull requests can be merged.</p>
<p>Configuring a code scanning rule will not automatically enable code scanning. For more information about how to enable code scanning, see <a href="/en/code-security/code-scanning/enabling-code-scanning/configuring-default-setup-for-code-scanning">Configuring default setup for code scanning</a>.</p>
<p>For more information about code scanning alerts, see <a href="/en/code-security/code-scanning/managing-code-scanning-alerts/about-code-scanning-alerts">About code scanning alerts</a>.</p>
<p>You can set merge protection with rulesets at the repository level, and for repositories configured with either default setup or advanced setup. You can also use the REST API to set merge protection with rulesets.</p>
<p>For more information about rulesets, see <a href="/en/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets">About rulesets</a>.</p>
<h2><a href="#creating-a-merge-protection-ruleset-for-a-repository">Creating a merge protection ruleset for a repository</a></h2>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-28260/images/help/repository/repo-actions-settings.png" alt='Screenshot of a repository header showing the tabs. The "Settings" tab is highlighted by a dark orange outline.' width="720" height="71"></source></picture></div>
</li>
<li>
<p>In the left sidebar, under "Code and automation," click <strong>Rules</strong>, then click <strong>Rulesets</strong>.</p>
<div><picture><source><img src="/assets/cb-80504/images/help/repository/rulesets-settings.png" alt='Screenshot of the sidebar of the "Settings" page for a repository. The "Rules" sub-menu is expanded, and the "Rulesets" option is outlined in orange.' width="343" height="550"></source></picture></div>
</li>
<li>
<p>Click <strong>New ruleset</strong>.</p>
</li>
<li>
<p>To create a ruleset targeting branches, click <strong>New branch ruleset</strong>.</p>
</li>
<li>
<p>Under "Ruleset name," type a name for the ruleset.</p>
</li>
<li>
<p>Optionally, to change the default enforcement status, click <a href="/en/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets#using-ruleset-enforcement-statuses">About rulesets</a>.</p>
</li>
<li>
<p>Under "Branch protections", select <strong>Require code scanning results</strong>.</p>
</li>
<li>
<p>Under "Required tools and alert thresholds", click </p>
</li>
<li>
<p>Next to the name of a code scanning tool:</p>
<ul>
<li>Click <strong>Alerts</strong> and select one of: <strong>None</strong>, <strong>Errors</strong>, <strong>Errors and Warnings</strong> or <strong>All</strong>.</li>
<li>Click <strong>Security alerts</strong> and select one of: <strong>None</strong>, <strong>Critical</strong>, <strong>High or higher</strong>, <strong>Medium or higher</strong>, or <strong>All</strong>.</li>
</ul>
<div><picture><source><img src="/assets/cb-42772/images/help/repository/rulesets-require-code-scanning.png" alt='Screenshot of the "Required tools and alert thresholds" section of "Rulesets" settings.' width="720" height="191"></source></picture></div>
</li>
</ol>
<p>For more information about alert severity and security severity levels, see <a href="/en/code-security/code-scanning/managing-code-scanning-alerts/about-code-scanning-alerts#about-alert-severity-and-security-severity-levels">About code scanning alerts</a>.</p>
<p>For more information about managing rulesets in a repository, see <a href="/en/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets">Managing rulesets for a repository</a>.</p>
<h2><a href="#creating-a-merge-protection-ruleset-with-the-rest-api">Creating a merge protection ruleset with the REST API</a></h2>
<p>You can use the REST API to create a ruleset with the <code>code_scanning</code> rule, which allows you to define specific tools and set alert thresholds. For more information, see <a href="/en/rest/repos/rules?apiVersion=2022-11-28#create-a-repository-ruleset">REST API endpoints for rules</a>.</p>
</div></div></div>
</div>
</div></main>
</div></body></html>