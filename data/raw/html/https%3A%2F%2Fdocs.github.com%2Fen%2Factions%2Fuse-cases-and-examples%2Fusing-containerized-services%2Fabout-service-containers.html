<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="GitHub Actions" href="/en/actions">GitHub Actions</a><span>/</span>
</li>
<li>
<a title="Use cases and examples" href="/en/actions/use-cases-and-examples">Use cases and examples</a><span>/</span>
</li>
<li>
<a title="Containerized services" href="/en/actions/use-cases-and-examples/using-containerized-services">Containerized services</a><span>/</span>
</li>
<li><a title="About service containers" href="/en/actions/use-cases-and-examples/using-containerized-services/about-service-containers">About service containers</a></li>
</ul></nav></div>
<div>
<div><div><h1>About service containers</h1></div></div>
<div><div><p>You can use service containers to connect databases, web services, memory caches, and other tools to your workflow.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#about-service-containers"><div><span>About service containers</span></div></a></li>
<li><a href="#communicating-with-service-containers"><div><span>Communicating with service containers</span></div></a></li>
<li><a href="#creating-service-containers"><div><span>Creating service containers</span></div></a></li>
<li><a href="#mapping-docker-host-and-service-container-ports"><div><span>Mapping Docker host and service container ports</span></div></a></li>
<li><a href="#authenticating-with-image-registries"><div><span>Authenticating with image registries</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<h2><a href="#about-service-containers">About service containers</a></h2>
<p>Service containers are Docker containers that provide a simple and portable way for you to host services that you might need to test or operate your application in a workflow. For example, your workflow might need to run integration tests that require access to a database and memory cache.</p>
<p>You can configure service containers for each job in a workflow. GitHub creates a fresh Docker container for each service configured in the workflow, and destroys the service container when the job completes. Steps in a job can communicate with all service containers that are part of the same job. However, you cannot create and use service containers inside a composite action.</p>
<div>
<p>
If your workflows use Docker container actions, job containers, or service containers, then you must use a Linux runner:</p>
<ul>
<li>If you are using GitHub-hosted runners, you must use an Ubuntu runner.</li>
<li>If you are using self-hosted runners, you must use a Linux machine as your runner and Docker must be installed.</li>
</ul>
</div>
<h2><a href="#communicating-with-service-containers">Communicating with service containers</a></h2>
<p>You can configure jobs in a workflow to run directly on a runner machine or in a Docker container. Communication between a job and its service containers is different depending on whether a job runs directly on the runner machine or in a container.</p>
<h3><a href="#running-jobs-in-a-container">Running jobs in a container</a></h3>
<p>When you run jobs in a container, GitHub connects service containers to the job using Docker's user-defined bridge networks. For more information, see <a href="https://docs.docker.com/engine/network/drivers/bridge/">Bridge network driver</a> in the Docker documentation.</p>
<p>Running the job and services in a container simplifies network access. You can access a service container using the label you configure in the workflow. The hostname of the service container is automatically mapped to the label name. For example, if you create a service container with the label <code>redis</code>, the hostname of the service container is <code>redis</code>.</p>
<p>You don't need to configure any ports for service containers. By default, all containers that are part of the same Docker network expose all ports to each other, and no ports are exposed outside of the Docker network.</p>
<h3><a href="#running-jobs-on-the-runner-machine">Running jobs on the runner machine</a></h3>
<p>When running jobs directly on the runner machine, you can access service containers using <code>localhost:&lt;port&gt;</code> or <code>127.0.0.1:&lt;port&gt;</code>. GitHub configures the container network to enable communication from the service container to the Docker host.</p>
<p>When a job runs directly on a runner machine, the service running in the Docker container does not expose its ports to the job on the runner by default. You need to map ports on the service container to the Docker host. For more information, see <a href="/en/actions/using-containerized-services/about-service-containers#mapping-docker-host-and-service-container-ports">About service containers</a>.</p>
<h2><a href="#creating-service-containers">Creating service containers</a></h2>
<p>You can use the <code>services</code> keyword to create service containers that are part of a job in your workflow. For more information, see <a href="/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idservices"><code>jobs.&lt;job_id&gt;.services</code></a>.</p>
<p>This example creates a service called <code>redis</code> in a job called <code>container-job</code>. The Docker host in this example is the <code>node:16-bullseye</code> container.</p>
<div>
<header><span>YAML</span><pre>name: Redis container example
on: push

jobs:
  # Label of the container job
  container-job:
    # Containers must run in Linux based operating systems
    runs-on: ubuntu-latest
    # Docker Hub image that `container-job` executes in
    container: node:16-bullseye

    # Service containers to run with `container-job`
    services:
      # Label used to access the service container
      redis:
        # Docker Hub image
        image: redis
</pre></header><pre><code><span>name:</span> <span>Redis</span> <span>container</span> <span>example</span>
<span>on:</span> <span>push</span>

<span>jobs:</span>
  <span># Label of the container job</span>
  <span>container-job:</span>
    <span># Containers must run in Linux based operating systems</span>
    <span>runs-on:</span> <span>ubuntu-latest</span>
    <span># Docker Hub image that `container-job` executes in</span>
    <span>container:</span> <span>node:16-bullseye</span>

    <span># Service containers to run with `container-job`</span>
    <span>services:</span>
      <span># Label used to access the service container</span>
      <span>redis:</span>
        <span># Docker Hub image</span>
        <span>image:</span> <span>redis</span>
</code></pre>
</div>
<h2><a href="#mapping-docker-host-and-service-container-ports">Mapping Docker host and service container ports</a></h2>
<p>If your job runs in a Docker container, you do not need to map ports on the host or the service container. If your job runs directly on the runner machine, you'll need to map any required service container ports to ports on the host runner machine.</p>
<p>You can map service containers ports to the Docker host using the <code>ports</code> keyword. For more information, see <a href="/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idservices"><code>jobs.&lt;job_id&gt;.services</code></a>.</p>





















<table>
<thead><tr>
<th>Value of <code>ports</code>
</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>8080:80</code></td>
<td>Maps TCP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td><code>8080:80/udp</code></td>
<td>Maps UDP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td><code>8080/udp</code></td>
<td>Maps a randomly chosen port on the Docker host to UDP port 8080 in the container.</td>
</tr>
</tbody>
</table>
<p>When you map ports using the <code>ports</code> keyword, GitHub uses the <code>--publish</code> command to publish the containerâ€™s ports to the Docker host. For more information, see <a href="https://docs.docker.com/config/containers/container-networking/">Docker container networking</a> in the Docker documentation.</p>
<p>When you specify the container port but not the Docker host port, the container port is randomly assigned to a free port. GitHub sets the assigned container port in the service container context. For example, for a <code>redis</code> service container, if you configured the Docker host port 5432, you can access the corresponding container port using the <code>job.services.redis.ports[5432]</code> context. For more information, see <a href="/en/actions/learn-github-actions/contexts#job-context">Accessing contextual information about workflow runs</a>.</p>
<h3><a href="#example-mapping-redis-ports">Example mapping Redis ports</a></h3>
<p>This example maps the service container <code>redis</code> port 6379 to the Docker host port 6379.</p>
<div>
<header><span>YAML</span><pre>name: Redis Service Example
on: push

jobs:
  # Label of the container job
  runner-job:
    # You must use a Linux environment when using service containers or container jobs
    runs-on: ubuntu-latest

    # Service containers to run with `runner-job`
    services:
      # Label used to access the service container
      redis:
        # Docker Hub image
        image: redis
        #
        ports:
          # Opens tcp port 6379 on the host and service container
          - 6379:6379
</pre></header><pre><code><span>name:</span> <span>Redis</span> <span>Service</span> <span>Example</span>
<span>on:</span> <span>push</span>

<span>jobs:</span>
  <span># Label of the container job</span>
  <span>runner-job:</span>
    <span># You must use a Linux environment when using service containers or container jobs</span>
    <span>runs-on:</span> <span>ubuntu-latest</span>

    <span># Service containers to run with `runner-job`</span>
    <span>services:</span>
      <span># Label used to access the service container</span>
      <span>redis:</span>
        <span># Docker Hub image</span>
        <span>image:</span> <span>redis</span>
        <span>#</span>
        <span>ports:</span>
          <span># Opens tcp port 6379 on the host and service container</span>
          <span>-</span> <span>6379</span><span>:6379</span>
</code></pre>
</div>
<h2><a href="#authenticating-with-image-registries">Authenticating with image registries</a></h2>
<p>You can specify credentials for your service containers in case you need to authenticate with an image registry. This allows you to use images from private registries or to <a href="https://www.docker.com/increase-rate-limits/">increase your DockerHub rate limit</a>.</p>
<p>Hereâ€™s an example of authenticating with Docker Hub and the GitHub Container registry:</p>
<div>
<header><span>YAML</span><pre>jobs:
  build:
    services:
      redis:
        # Docker Hub image
        image: redis
        ports:
          - 6379:6379
        credentials:
          username: ${{ secrets.dockerhub_username }}
          password: ${{ secrets.dockerhub_password }}
      db:
        # Private registry image
        image: ghcr.io/octocat/testdb:latest
        credentials:
          username: ${{ github.repository_owner }}
          password: ${{ secrets.ghcr_password }}
</pre></header><pre><code><span>jobs:</span>
  <span>build:</span>
    <span>services:</span>
      <span>redis:</span>
        <span># Docker Hub image</span>
        <span>image:</span> <span>redis</span>
        <span>ports:</span>
          <span>-</span> <span>6379</span><span>:6379</span>
        <span>credentials:</span>
          <span>username:</span> <span>${{</span> <span>secrets.dockerhub_username</span> <span>}}</span>
          <span>password:</span> <span>${{</span> <span>secrets.dockerhub_password</span> <span>}}</span>
      <span>db:</span>
        <span># Private registry image</span>
        <span>image:</span> <span>ghcr.io/octocat/testdb:latest</span>
        <span>credentials:</span>
          <span>username:</span> <span>${{</span> <span>github.repository_owner</span> <span>}}</span>
          <span>password:</span> <span>${{</span> <span>secrets.ghcr_password</span> <span>}}</span>
</code></pre>
</div>
<h2><a href="#further-reading">Further reading</a></h2>
<ul>
<li><a href="/en/actions/using-containerized-services/creating-redis-service-containers">Creating Redis service containers</a></li>
<li><a href="/en/actions/using-containerized-services/creating-postgresql-service-containers">Creating PostgreSQL service containers</a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>