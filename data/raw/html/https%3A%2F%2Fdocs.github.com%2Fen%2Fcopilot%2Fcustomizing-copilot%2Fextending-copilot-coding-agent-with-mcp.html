<html><body><div>
<main><div>
<div><nav><ul>
<li>
<a title="GitHub Copilot" href="/en/copilot">GitHub Copilot</a><span>/</span>
</li>
<li>
<a title="Customize Copilot" href="/en/copilot/customizing-copilot">Customize Copilot</a><span>/</span>
</li>
<li><a title="Extend coding agent with MCP" href="/en/copilot/customizing-copilot/extending-copilot-coding-agent-with-mcp">Extend coding agent with MCP</a></li>
</ul></nav></div>
<div>
<div><div><h1>Extending Copilot coding agent with the Model Context Protocol (MCP)</h1></div></div>
<div><div><p>Learn how to use the Model Context Protocol (MCP) to extend the capabilities of Copilot coding agent.</p></div></div>
<div>
<h2>In this article</h2>
<nav><ul>
<li><a href="#staying-safe-with-mcp-servers"><div><span>Staying safe with MCP servers</span></div></a></li>
<li><a href="#about-setting-up-mcp-servers-in-a-repository"><div><span>About setting up MCP servers in a repository</span></div></a></li>
<li><a href="#example-configurations"><div><span>Example configurations</span></div></a></li>
<li><a href="#reusing-your-mcp-configuration-from-visual-studio-code"><div><span>Reusing your MCP configuration from Visual Studio Code</span></div></a></li>
<li><a href="#adding-your-configuration-to-your-repository"><div><span>Adding your configuration to your repository</span></div></a></li>
<li><a href="#validating-your-mcp-configuration"><div><span>Validating your MCP configuration</span></div></a></li>
<li><a href="#customizing-the-built-in-github-mcp-server"><div><span>Customizing the built-in GitHub MCP server</span></div></a></li>
<li><a href="#best-practices"><div><span>Best practices</span></div></a></li>
<li><a href="#further-reading"><div><span>Further reading</span></div></a></li>
</ul></nav>
</div>
<div><div><div>
<div>
<p>
Copilot coding agent is in public preview and subject to change.</p>
<p>For more information about Copilot coding agent, see <a href="/en/copilot/using-github-copilot/coding-agent/about-assigning-tasks-to-copilot">About assigning tasks to Copilot</a>.</p>
</div>
<p>The Model Context Protocol (MCP) is an open standard that defines how applications share context with large language models (LLMs). MCP provides a standardized way to connect AI models to different data sources and tools, enabling them to work together more effectively.</p>
<p>You can use MCP to extend the capabilities of Copilot coding agent by connecting it to other tools and services.</p>
<p>The agent can use tools provided by local MCP servers. For example, the <a href="https://github.com/microsoft/playwright-mcp">Playwright MCP server</a> provides tools to interact with web pages and pull in additional context when executing on the requested task.</p>
<p>For more information on MCP, see <a href="https://modelcontextprotocol.io/introduction">the official MCP documentation</a>. For information on some of the currently available MCP servers, see <a href="https://github.com/modelcontextprotocol/servers/tree/main">the MCP servers repository</a>.</p>
<div>
<ul>
<li>Copilot coding agent only supports tools provided by MCP servers. It does not support resources or prompts.</li>
<li>Copilot coding agent currently only supports local MCP servers. To learn more about transport types, see the <a href="https://modelcontextprotocol.io/docs/concepts/transports">official MCP documentation</a>.</li>
</ul>
</div>
<h2><a href="#staying-safe-with-mcp-servers">Staying safe with MCP servers</a></h2>
<p>Once you've configured an MCP server, Copilot will be able to use the tools provided by the server autonomously, and will not ask for your approval before using them.</p>
<p>We recommend that you restrict your servers to read-only tools. You can use the <code>tools</code> configuration option to only expose known, safe tools to Copilot.</p>
<h2><a href="#about-setting-up-mcp-servers-in-a-repository">About setting up MCP servers in a repository</a></h2>
<p>As a repository administrator, you can configure MCP servers for use within your repository. This is done via a JSON-formatted configuration that specifies the details of the MCP servers you want to use. You enter the JSON configuration directly into the settings for the repository on GitHub.com.</p>
<p>Once MCP servers are configured for use within a repository, the tools specified in the configuration will be available to Copilot coding agent on each assigned task.</p>
<h3><a href="#creating-your-json-mcp-configuration">Creating your JSON MCP configuration</a></h3>
<p>You configure MCP servers using a special JSON format. The JSON must contain an <code>mcpServers</code> object, where the key is the name of the MCP server (for example, <code>playwright</code>), and the value is an object with the configuration for that MCP server.</p>
<div>
<header><span>JSON</span><pre>{
  "mcpServers": {
    "MCP SERVER 1": {
      "command": "VALUE",
      "args": [ VALUES ],
      ...
    },
    "MCP SERVER 2": {
      "command": "VALUE",
      "args": [ VALUES ],
      ...
    },
    ...
  }
}
</pre></header><pre><code><span>{</span>
  <span>"mcpServers"</span><span>:</span> <span>{</span>
    <span>"MCP SERVER 1"</span><span>:</span> <span>{</span>
      <span>"command"</span><span>:</span> <span>"VALUE"</span><span>,</span>
      <span>"args"</span><span>:</span> <span>[</span> VALUES <span>]</span><span>,</span>
      ...
    <span>}</span><span>,</span>
    <span>"MCP SERVER 2"</span><span>:</span> <span>{</span>
      <span>"command"</span><span>:</span> <span>"VALUE"</span><span>,</span>
      <span>"args"</span><span>:</span> <span>[</span> VALUES <span>]</span><span>,</span>
      ...
    <span>}</span><span>,</span>
    ...
  <span>}</span>
<span>}</span>
</code></pre>
</div>
<p>The configuration object can contain the following keys:</p>
<ul>
<li>
<code>command</code> (<code>string</code>): The command to run to start the MCP server.</li>
<li>
<code>args</code> (<code>string[]</code>): The arguments to pass to the <code>command</code>.</li>
<li>
<code>tools</code> (<code>string[]</code>): The tools from the MCP server to enable. You may be able to find a list of tools in the server's documentation, or in its code. We recommend that you allowlist specific tools, but you can also enable all tools by including <code>*</code> in the array.</li>
<li>
<code>type</code> (<code>string</code>): Optional field. Copilot coding agent only accepts <code>"local"</code>.</li>
<li>
<code>env</code> (<code>object</code>): The environment variables to pass to the server. This object should map the name of the environment variable that should be exposed to your MCP server to either of the following:
<ul>
<li>The name of a GitHub Actions secret you have configured, beginning with <code>COPILOT_MCP_</code>.</li>
<li>A string value.</li>
</ul>
</li>
</ul>
<h2><a href="#example-configurations">Example configurations</a></h2>
<h3><a href="#example-playwright">Example: Playwright</a></h3>
<p>The <a href="https://github.com/microsoft/playwright-mcp">Playwright MCP server</a> provides tools which allow Copilot to browse the internet.</p>
<div>
<header><span>JSON</span><pre>{
  "mcpServers": {
    "playwright": {
      "command": "docker",
      "args": ["run", "-i", "--rm", "--init", "mcp/playwright"],
      "tools": ["*"]
    }
  }
}
</pre></header><pre><code><span>{</span>
  <span>"mcpServers"</span><span>:</span> <span>{</span>
    <span>"playwright"</span><span>:</span> <span>{</span>
      <span>"command"</span><span>:</span> <span>"docker"</span><span>,</span>
      <span>"args"</span><span>:</span> <span>[</span><span>"run"</span><span>,</span> <span>"-i"</span><span>,</span> <span>"--rm"</span><span>,</span> <span>"--init"</span><span>,</span> <span>"mcp/playwright"</span><span>]</span><span>,</span>
      <span>"tools"</span><span>:</span> <span>[</span><span>"*"</span><span>]</span>
    <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre>
</div>
<h3><a href="#example-sentry">Example: Sentry</a></h3>
<p>The <a href="https://github.com/getsentry/sentry-mcp">Sentry MCP server</a> gives Copilot authenticated access to exceptions recorded in <a href="https://sentry.io">Sentry</a>.</p>
<div>
<header><span>JavaScript</span><pre>// If you copy and paste this example, you will need to remove the comments prefixed with `//`, which are not valid JSON.
{
  "mcpServers": {
    "sentry": {
      "command": "npx",
      // We can use the $SENTRY_HOST environment variable which is passed to
      // the server because of the `env` value below.
      "args": ["@sentry/mcp-server@latest", "--host=$SENTRY_HOST"],
      "tools": ["get_issue_details", "get_issue_summary"],
      "env": {
        // We can specify an environment variable value as a string...
        "SENTRY_HOST": "https://contoso.sentry.io",
        // or refer to a GitHub Actions secret with a name starting with
        // `COPILOT_MCP_`
        "SENTRY_AUTH_TOKEN": "COPILOT_MCP_SENTRY_AUTH_TOKEN"
      }
    }
  }
}
</pre></header><pre><code><span>// If you copy and paste this example, you will need to remove the comments prefixed with `//`, which are not valid JSON.</span>
{
  <span>"mcpServers"</span>: {
    <span>"sentry"</span>: {
      <span>"command"</span>: <span>"npx"</span>,
      <span>// We can use the $SENTRY_HOST environment variable which is passed to</span>
      <span>// the server because of the `env` value below.</span>
      <span>"args"</span>: [<span>"@sentry/mcp-server@latest"</span>, <span>"--host=$SENTRY_HOST"</span>],
      <span>"tools"</span>: [<span>"get_issue_details"</span>, <span>"get_issue_summary"</span>],
      <span>"env"</span>: {
        <span>// We can specify an environment variable value as a string...</span>
        <span>"SENTRY_HOST"</span>: <span>"https://contoso.sentry.io"</span>,
        <span>// or refer to a GitHub Actions secret with a name starting with</span>
        <span>// `COPILOT_MCP_`</span>
        <span>"SENTRY_AUTH_TOKEN"</span>: <span>"COPILOT_MCP_SENTRY_AUTH_TOKEN"</span>
      }
    }
  }
}
</code></pre>
</div>
<h3><a href="#example-notion">Example: Notion</a></h3>
<p>The <a href="https://github.com/makenotion/notion-mcp-server">Notion MCP server</a> gives Copilot authenticated access to notes and other content from <a href="https://notion.so">Notion</a>.</p>
<div>
<header><span>JavaScript</span><pre>// If you copy and paste this example, you will need to remove the comments prefixed with `//`, which are not valid JSON.
{
  "mcpServers": {
    "notionApi": {
      "command": "docker",
      "args": [
        "run",
        "--rm",
        "-i",
        "-e",
        // We can use the $NOTION_API_KEY environment variable which is passed to
        // the server because of the `env` value below.
        "OPENAPI_MCP_HEADERS={\"Authorization\": \"Bearer $NOTION_API_KEY\", \"Notion-Version\": \"2022-06-28\"}",
       "mcp/notion"
      ],
      "env": {
        // The value of the `COPILOT_MCP_NOTION_API_KEY` secret will be passed to the
        // server command as an environment variable called `NOTION_API_KEY`
        "NOTION_API_KEY": "COPILOT_MCP_NOTION_API_KEY"
      },
      "tools": ["*"]
    }
  }
}
</pre></header><pre><code><span>// If you copy and paste this example, you will need to remove the comments prefixed with `//`, which are not valid JSON.</span>
{
  <span>"mcpServers"</span>: {
    <span>"notionApi"</span>: {
      <span>"command"</span>: <span>"docker"</span>,
      <span>"args"</span>: [
        <span>"run"</span>,
        <span>"--rm"</span>,
        <span>"-i"</span>,
        <span>"-e"</span>,
        <span>// We can use the $NOTION_API_KEY environment variable which is passed to</span>
        <span>// the server because of the `env` value below.</span>
        <span>"OPENAPI_MCP_HEADERS={\"Authorization\": \"Bearer $NOTION_API_KEY\", \"Notion-Version\": \"2022-06-28\"}"</span>,
       <span>"mcp/notion"</span>
      ],
      <span>"env"</span>: {
        <span>// The value of the `COPILOT_MCP_NOTION_API_KEY` secret will be passed to the</span>
        <span>// server command as an environment variable called `NOTION_API_KEY`</span>
        <span>"NOTION_API_KEY"</span>: <span>"COPILOT_MCP_NOTION_API_KEY"</span>
      },
      <span>"tools"</span>: [<span>"*"</span>]
    }
  }
}
</code></pre>
</div>
<h3><a href="#example-azure">Example: Azure</a></h3>
<p>The <a href="https://github.com/Azure/azure-mcp">Azure MCP server</a> creates a seamless connection between Copilot and key Azure services such as Azure Cosmos DB and the Azure Storage platform.</p>
<p>To use the Azure MCP with Copilot coding agent, you must update the repository's <code>copilot-setup-steps.yml</code> file to include an Azure login workflow step.</p>
<ol>
<li>
<p>Configure OIDC in a Microsoft Entra application, trusting GitHub. See <a href="https://learn.microsoft.com/en-us/azure/developer/github/connect-from-azure-openid-connect">Use the Azure Login action with OpenID Connect</a>.</p>
</li>
<li>
<p>Add a <code>.github/workflows/copilot-setup-steps.yml</code> Actions workflow file in your repository if you do not already have one.</p>
</li>
<li>
<p>Add an Azure login step to the <code>copilot-setup-steps</code> workflow job.</p>
<div>
<header><span>YAML</span><pre>on:
  workflow_dispatch:
permissions:
  id-token: write
  contents: read
jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
    environment: Copilot
    steps:
      - name: Azure login
        uses: azure/login@a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0
        with:
          client-id: $
          tenant-id: $
          subscription-id: $
</pre></header><pre><code><span>on:</span>
  <span>workflow_dispatch:</span>
<span>permissions:</span>
  <span>id-token:</span> <span>write</span>
  <span>contents:</span> <span>read</span>
<span>jobs:</span>
  <span>copilot-setup-steps:</span>
    <span>runs-on:</span> <span>ubuntu-latest</span>
    <span>permissions:</span>
      <span>id-token:</span> <span>write</span>
      <span>contents:</span> <span>read</span>
    <span>environment:</span> <span>Copilot</span>
    <span>steps:</span>
      <span>-</span> <span>name:</span> <span>Azure</span> <span>login</span>
        <span>uses:</span> <span>azure/login@a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0</span>
        <span>with:</span>
          <span>client-id:</span> <span>$</span>
          <span>tenant-id:</span> <span>$</span>
          <span>subscription-id:</span> <span>$</span>
</code></pre>
</div>
<p>This configuration ensures the <code>azure/login</code> action is executed when Copilot coding agent runs.</p>
</li>
<li>
<p>In your repository’s Copilot environment, add secrets for your <code>AZURE_CLIENT_ID</code>, <code>AZURE_TENANT_ID</code> and <code>AZURE_SUBSCRIPTION_ID</code>.</p>
</li>
<li>
<p>Configure the Azure MCP server by adding an <code>azure</code> object to your MCP configuration.</p>
<div>
<header><span>JSON</span><pre>{
  "mcpServers": {
    "Azure MCP Server": {
      "command": "npx",
      "args": [
        "-y",
        "@azure/mcp@latest",
        "server",
        "start"
      ]
    }
  }
}
</pre></header><pre><code><span>{</span>
  <span>"mcpServers"</span><span>:</span> <span>{</span>
    <span>"Azure MCP Server"</span><span>:</span> <span>{</span>
      <span>"command"</span><span>:</span> <span>"npx"</span><span>,</span>
      <span>"args"</span><span>:</span> <span>[</span>
        <span>"-y"</span><span>,</span>
        <span>"@azure/mcp@latest"</span><span>,</span>
        <span>"server"</span><span>,</span>
        <span>"start"</span>
      <span>]</span>
    <span>}</span>
  <span>}</span>
<span>}</span>
</code></pre>
</div>
</li>
</ol>
<h2><a href="#reusing-your-mcp-configuration-from-visual-studio-code">Reusing your MCP configuration from Visual Studio Code</a></h2>
<p>If you have already configured MCP servers in VS Code, you can leverage a similar configuration for Copilot coding agent.</p>
<p>Depending on how VS Code is configured, you may be able to find your MCP settings in your repository's <code>.vscode/mcp.json</code> file, or in your machine's private <code>settings.json</code> file.</p>
<p>To adapt the configuration for Copilot coding agent, you will need to:</p>
<ol>
<li>Add a <code>tools</code> key for each MCP server, specifying which tools will be available to Copilot.</li>
<li>If you've configured <code>inputs</code>, switch to using <code>env</code> directly.</li>
<li>If you've configured an <code>envFile</code>, switch to using <code>env</code> directly.</li>
<li>Update any references to <code>inputs</code> in your <code>args</code> configuration to refer to environment variables from <code>env</code> instead.</li>
</ol>
<p>For more information on MCP in VS Code, see the <a href="https://code.visualstudio.com/docs/copilot/chat/mcp-servers">VS Code docs</a>.</p>
<h2><a href="#adding-your-configuration-to-your-repository">Adding your configuration to your repository</a></h2>
<p>Repository administrators can configure MCP servers by following these steps:</p>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-28260/images/help/repository/repo-actions-settings.png" alt='Screenshot of a repository header showing the tabs. The "Settings" tab is highlighted by a dark orange outline.' width="720" height="71"></source></picture></div>
</li>
<li>
<p>In the "Code &amp; automation" section of the sidebar, click <strong>Copilot</strong> then <strong>Copilot agent</strong>.</p>
</li>
<li>
<p>Add your configuration in the <strong>MCP configuration</strong> section.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
<p>Your configuration will be validated to ensure proper syntax.</p>
</li>
<li>
<p>If your MCP server requires a key or secret, add a secret to your Copilot environment. Only secrets with names prefixed with <code>COPILOT_MCP_</code> will be available to your MCP configuration. See <a href="#setting-up-a-copilot-environment-for-copilot-coding-agent">Setting up a Copilot environment for Copilot coding agent</a>.</p>
</li>
</ol>
<h3><a href="#setting-up-a-copilot-environment-for-copilot-coding-agent">Setting up a Copilot environment for Copilot coding agent</a></h3>
<p>Some MCP servers will require keys or secrets. To leverage those servers in Copilot coding agent, you can add secrets to an environment for Copilot. This ensures the secrets are properly recognized and passed to the applicable MCP server that you have configured.</p>
<p>You must be a repository administrator to configure a Copilot environment for your repository.</p>
<ol>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-28260/images/help/repository/repo-actions-settings.png" alt='Screenshot of a repository header showing the tabs. The "Settings" tab is highlighted by a dark orange outline.' width="720" height="71"></source></picture></div>
</li>
<li>
<p>In the left sidebar, click <strong>Environments</strong>.</p>
</li>
<li>
<p>Click <strong>New environment</strong>.</p>
</li>
<li>
<p>Call the new environment <code>copilot</code> and click <strong>Configure environment</strong>.</p>
</li>
<li>
<p>Under "Environment secrets", click <strong>Add environment secret</strong>.</p>
</li>
<li>
<p>Give the secret a name beginning <code>COPILOT_MCP_</code>, add the secret value, then click <strong>Add secret</strong>.</p>
</li>
</ol>
<h2><a href="#validating-your-mcp-configuration">Validating your MCP configuration</a></h2>
<p>Once you've set up your MCP configuration, you should test it to make sure it is set up correctly.</p>
<ol>
<li>Create an issue in the repository, then assign it to Copilot.</li>
<li>Wait a few seconds, and Copilot will leave an 👀 reaction on the issue.</li>
<li>Wait a few more seconds, and Copilot will create a pull request, which will appear in the issue's timeline.</li>
<li>Click the created pull request in the timeline, and wait until a "Copilot started work" timeline event appears.</li>
<li>Click <strong>View session</strong> to open the Copilot coding agent logs.</li>
<li>Click the ellipsis button (<strong>...</strong>) at the top right of the log viewer, then click <strong>Copilot</strong> in the sidebar.</li>
<li>Click the <strong>Start MCP Servers</strong> step to expand the logs.</li>
<li>If your MCP servers have been started successfully, you will see their tools listed at the bottom of the logs.</li>
</ol>
<p>If your MCP servers require any dependencies that are not installed on the GitHub Actions runner by default, such as <code>uv</code> and <code>pipx</code>, or that need special setup steps, you may need to create a <code>copilot-setup-steps.yml</code> Actions workflow file to install them. For more information, see <a href="/en/copilot/customizing-copilot/customizing-the-development-environment-for-copilot-coding-agent">Customizing the development environment for Copilot coding agent</a>.</p>
<h2><a href="#customizing-the-built-in-github-mcp-server">Customizing the built-in GitHub MCP server</a></h2>
<p>The GitHub MCP server is enabled by default, giving Copilot access to GitHub data like issues and pull requests.</p>
<p>By default, the MCP server connects to GitHub with a specially scoped token that only has read-only access to the current repository.</p>
<p>If you want to allow Copilot to access data outside the current repository, you can give it a personal access token with wider access.</p>
<ol>
<li>
<p>Create a personal access token with the appropriate permissions. We recommend using a fine-grained personal access token, where you can limit the token's access to read-only permissions on specific repositories. For more information on personal access tokens, see <a href="/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">Managing your personal access tokens</a>.</p>
</li>
<li>
<p>On GitHub, navigate to the main page of the repository.</p>
</li>
<li>
<p>Under your repository name, click <strong>Settings</strong>.</p>
<div><picture><source><img src="/assets/cb-28260/images/help/repository/repo-actions-settings.png" alt='Screenshot of a repository header showing the tabs. The "Settings" tab is highlighted by a dark orange outline.' width="720" height="71"></source></picture></div>
</li>
<li>
<p>In the "Code &amp; automation" section of the sidebar, click <strong>Copilot</strong> then <strong>Copilot agent</strong>.</p>
</li>
<li>
<p>Add your configuration in the <strong>MCP configuration</strong> section.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
<li>
<p>In the left sidebar, click <strong>Environments</strong>.</p>
</li>
<li>
<p>Click the <code>copilot</code> environment.</p>
</li>
<li>
<p>Under "Environment secrets", click <strong>Add environment secret</strong>.</p>
</li>
<li>
<p>Call the secret <code>COPILOT_MCP_GITHUB_PERSONAL_ACCESS_TOKEN</code>, enter your personal access token in the "Value" field, then click <strong>Add secret</strong>.</p>
</li>
</ol>
<h2><a href="#best-practices">Best practices</a></h2>
<ul>
<li>
<p>Enabling third-party MCP servers for use may impact the performance of the agent and the quality of the outputs. Review the third-party MCP server thoroughly and ensure that it meets your organization’s requirements.</p>
</li>
<li>
<p>By default, Copilot coding agent does not have access to write MCP server tools. However, some MCP servers do contain such tools. Be sure to review the tools available in the MCP server you want to use. Update the <code>tools</code> field in the MCP configuration with only the necessary tooling.</p>
</li>
<li>
<p>Carefully review the configured MCP servers prior to saving the configuration to ensure the correct servers are configured for use.</p>
</li>
</ul>
<h2><a href="#further-reading">Further reading</a></h2>
<ul>
<li><a href="/en/copilot/customizing-copilot/customizing-the-development-environment-for-copilot-coding-agent">Customizing the development environment for Copilot coding agent</a></li>
<li><a href="/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp">Extending Copilot Chat with the Model Context Protocol (MCP)</a></li>
</ul>
</div></div></div>
</div>
</div></main>
</div></body></html>